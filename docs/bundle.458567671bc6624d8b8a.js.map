{"version":3,"sources":["webpack:///bundle.458567671bc6624d8b8a.js","webpack:///webpack/bootstrap fc4e4203504d7cca54d0","webpack:///./utils.ts","webpack:///./event-store.ts","webpack:///./read.ts","webpack:///./app.common.ts","webpack:///./controllers/completed-todo-list-panel-controller.ts","webpack:///./controllers/event-list-controller.ts","webpack:///./controllers/todo-list-controller.ts","webpack:///./controllers/todo-list-panel-controller.ts","webpack:///./controllers/todo-title-controller.ts","webpack:///./domain/todo-list.ts","webpack:///./~/uuid/index.js","webpack:///./~/uuid/lib/bytesToUuid.js","webpack:///./~/uuid/lib/rng-browser.js","webpack:///./controllers/body-controller.ts","webpack:///./app.ts","webpack:///./controllers/todo-actions-panel-buttons-controller.ts","webpack:///./controllers/todo-actions-panel-controller.ts","webpack:///./controllers/todo-controller.ts","webpack:///./controllers/todo-list-group-controller.ts","webpack:///./controllers/todo-rename-panel-controller.ts","webpack:///./controllers/todo-title-panel-controller.ts","webpack:///./domain/aggregate-root.ts","webpack:///./domain/events.ts","webpack:///./domain/todo.ts","webpack:///./~/idb/lib/idb.js","webpack:///./~/uuid/v1.js","webpack:///./~/uuid/v4.js","webpack:///(webpack)/buildin/global.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","templateClone","id","selector","template","document","querySelector","Error","importNode","content","findControllerElement","parentNode","controllerName","findElement","setContentElement","propName","findContentElements","forEach","elem","textContent","findAllElements","setPropElements","attributeName","findPropElements","setAttribute","element","elements","querySelectorAll","length","replaceChildren","parent","newNode","innerHTML","appendChild","getRequiredAttribute","getAttribute","open","idb_1","default","dbName","db","oldVersion","createObjectStore","domainEventStoreName","autoIncrement","keyPath","eventIdPropName","createIndex","aggregateIdPropName","catch","reason","alert","allDomainEvents","version","then","store","transaction","objectStore","getAll","IDBKeyRange","upperBound","domainEventsByAggregate","aggregateId","index","eventsPromise","events","filter","e","postDomainEvents","tx","x","add","complete","DomainEventType","todoListEvents","event_store_1","lists","todoLists","reduce","type","TodoAdded","indexOf","push","refreshLists","todoListId","todoList","todo_list_1","TodoList","utils_1","todo_list_panel_controller_1","todoListPanelController","todos","completed_todo_list_panel_controller_1","completedTodoListPanelController","completedTodos","event_list_controller_1","eventListController","invalidNameInputHandler","clearValidation","$form","removeClass","$button","addClass","off","validationEventNamespace","$input","input","currentTarget","$","closest","next","children","timeStamp","toString","replace","on","validity","valid","setTimeout","contains","activeElement","DocumentFragment","fragment","todo_list_controller_1","todoListController","JSON","stringify","todo_list_group_controller_1","todoListGroupController","todoTitleController","todo","titleFragment","isCompleted","completionDateFragment","date","Date","completionTimestamp","toLocaleDateString","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","writable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","descriptor","key","protoProps","staticProps","_get","receiver","Function","desc","getOwnPropertyDescriptor","undefined","getPrototypeOf","aggregate_root_1","todo_1","events_1","uuid_1","_aggregate_root_1$Agg","this","apply","arguments","_todos","_id","Todo","todoId","todoName","findIndex","splice","oldTodo","newTodo","CompletedTodo","todoCompletionTimestamp","find","arraySwap","arr","y","a","_this2","incompleteTodoPositions","Array","from","to","todoOffset","_i","agId","v4","applyAndStage","TodoRemoved","TodoCompleted","TodoUncompleted","TodoRenamed","offset","TodoPositionChanged","sort","AggregateRoot","v1","uuid","bytesToUuid","buf","bth","byteToHex","substr","global","rng","crypto","msCrypto","getRandomValues","rnds8","Uint8Array","rnds","r","Math","random","bodyController","completeTodoBtnHandler","isComplete","which","todoActionsBtn","now","uncomplete","uncommittedEvents","app_common_1","addTodoForm","addTodoInput","submit","preventDefault","read_1","reset","$todoListDelegatedEventTarget","val","rename","changePosition","remove","$defaultPanel","$actionsPanel","$bothPanels","actionsBtnGroup","eventNamespace","toggle","closeEvent","originalEvent","$renamePanel","first","focus","relatedTarget","prev","body_controller_1","window","indexedDB","todoActionsPanelButtonsController","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","dataset","err","return","todoActionsPanelController","todo_title_controller_1","todo_actions_panel_buttons_controller_1","todoController","todo_title_panel_controller_1","todoTitlePanelController","todo_actions_panel_controller_1","todo_rename_panel_controller_1","todoRenamePanelController","todo_controller_1","inputId","newInputId","label","_this","init","_uncommittedEvents","_Todo","toArray","slice","promisifyRequest","request","Promise","resolve","reject","onsuccess","result","onerror","error","promisifyRequestCall","obj","method","args","promisifyCursorRequestCall","Cursor","proxyProperties","ProxyClass","targetProp","properties","prop","set","proxyRequestMethods","proxyMethods","proxyCursorRequestMethods","Index","_index","cursor","_cursor","_request","ObjectStore","_store","Transaction","idbTransaction","_tx","oncomplete","onabort","UpgradeDB","_db","DB","IDBIndex","IDBCursor","methodName","IDBObjectStore","IDBTransaction","IDBDatabase","funcName","callback","nativeObject","query","count","items","iterateCursor","continue","exp","upgradeCallback","onupgradeneeded","event","delete","options","b","clockseq","_clockseq","msecs","getTime","nsecs","_lastNSecs","dt","_lastMSecs","tl","tmh","node","_nodeId","_seedBytes","ii","g","eval"],"mappings":"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","file":"bundle.458567671bc6624d8b8a.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 15);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction templateClone(id) {\n    var selector = \"template#\" + id;\n    var template = document.querySelector(selector);\n    if (!template) {\n        throw new Error(\"Document missing required '\" + selector + \"' element\");\n    }\n    var fragment = document.importNode(template.content, true);\n    return fragment;\n}\nexports.templateClone = templateClone;\nfunction findControllerElement(parentNode, controllerName) {\n    var selector = \"[data-estd-controller='\" + controllerName + \"']\";\n    return findElement(parentNode, selector);\n}\nexports.findControllerElement = findControllerElement;\nfunction setContentElement(parentNode, propName, content) {\n    findContentElements(parentNode, propName).forEach(function (elem) {\n        return elem.textContent = content;\n    });\n}\nexports.setContentElement = setContentElement;\nfunction findContentElements(parentNode, propName) {\n    var selector = \"[data-estd-content='\" + propName + \"']\";\n    return findAllElements(parentNode, selector);\n}\nfunction setPropElements(parentNode, propName, value) {\n    var attributeName = \"data-estd-\" + propName;\n    findPropElements(parentNode, propName).forEach(function (elem) {\n        return elem.setAttribute(attributeName, value);\n    });\n}\nexports.setPropElements = setPropElements;\nfunction findPropElements(parentNode, propName) {\n    var selector = \"[data-estd-prop='\" + propName + \"']\";\n    return findAllElements(parentNode, selector);\n}\nfunction findElement(parentNode, selector) {\n    var element = parentNode.querySelector(selector);\n    if (!element) {\n        throw new Error(\"'\" + parentNode + \"' missing required '\" + selector + \"' element\");\n    }\n    return element;\n}\nexports.findElement = findElement;\nfunction findAllElements(parentNode, selector) {\n    var elements = parentNode.querySelectorAll(selector);\n    if (!elements.length) {\n        throw new Error(\"'\" + parentNode + \"' missing required '\" + selector + \"' element\");\n    }\n    return elements;\n}\nfunction replaceChildren(parent, newNode) {\n    parent.innerHTML = \"\";\n    parent.appendChild(newNode);\n}\nexports.replaceChildren = replaceChildren;\nfunction getRequiredAttribute(element, attributeName) {\n    var value = element.getAttribute(attributeName);\n    if (!value) {\n        throw new Error(\"'\" + element + \"' missing required '\" + attributeName + \"' attribute\");\n    }\n    return value;\n}\nexports.getRequiredAttribute = getRequiredAttribute;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar idb_1 = __webpack_require__(25);\nvar DomainEventType;\n(function (DomainEventType) {\n    DomainEventType[DomainEventType[\"TodoAdded\"] = 0] = \"TodoAdded\";\n    DomainEventType[DomainEventType[\"TodoRemoved\"] = 1] = \"TodoRemoved\";\n    DomainEventType[DomainEventType[\"TodoCompleted\"] = 2] = \"TodoCompleted\";\n    DomainEventType[DomainEventType[\"TodoUncompleted\"] = 3] = \"TodoUncompleted\";\n    DomainEventType[DomainEventType[\"TodoRenamed\"] = 4] = \"TodoRenamed\";\n    DomainEventType[DomainEventType[\"TodoPositionChanged\"] = 5] = \"TodoPositionChanged\";\n})(DomainEventType = exports.DomainEventType || (exports.DomainEventType = {}));\nvar dbName = \"estd-db\";\nvar domainEventStoreName = \"domain-event\";\nvar aggregateIdPropName = \"aggregateId\";\nvar eventIdPropName = \"id\";\nfunction open() {\n    return idb_1.default.open(dbName, 1, function (db) {\n        switch (db.oldVersion) {\n            case 0:\n                db.createObjectStore(domainEventStoreName, { autoIncrement: true, keyPath: eventIdPropName }).createIndex(aggregateIdPropName, aggregateIdPropName);\n        }\n    }).catch(function (reason) {\n        alert(\"Database error: \" + reason);\n    });\n}\nfunction allDomainEvents(version) {\n    return open().then(function (db) {\n        var store = db.transaction(domainEventStoreName).objectStore(domainEventStoreName);\n        return version ? store.getAll(IDBKeyRange.upperBound(version)) : store.getAll();\n    }).catch(function (reason) {\n        alert(\"Database error: \" + reason);\n    });\n}\nexports.allDomainEvents = allDomainEvents;\nfunction domainEventsByAggregate(aggregateId, version) {\n    return open().then(function (db) {\n        var index = db.transaction(domainEventStoreName).objectStore(domainEventStoreName).index(aggregateIdPropName);\n        var eventsPromise = index.getAll(aggregateId);\n        return version ? eventsPromise.then(function (events) {\n            return events.filter(function (e) {\n                return e.id <= version;\n            });\n        }) : eventsPromise;\n    }).catch(function (reason) {\n        alert(\"Database error: \" + reason);\n    });\n}\nexports.domainEventsByAggregate = domainEventsByAggregate;\nfunction postDomainEvents(events) {\n    return open().then(function (db) {\n        var tx = db.transaction(domainEventStoreName, \"readwrite\");\n        var store = tx.objectStore(domainEventStoreName);\n        events.forEach(function (x) {\n            return store.add(x);\n        });\n        return tx.complete;\n    }).catch(function (reason) {\n        alert(\"Database error: \" + reason);\n    });\n}\nexports.postDomainEvents = postDomainEvents;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar event_store_1 = __webpack_require__(1);\nfunction todoListEvents() {\n    // This app's domain and event-store are designed to accommodate multiple aggregates of different types.\n    // Currently, the app only has one aggregate type (TodoList) and only allows the user to have one instance of that aggregate.\n    // This todoLists() lookup occurs to get the aggreateId of the user's one TodoList.\n    return event_store_1.allDomainEvents().then(function (events) {\n        var lists = todoLists(events);\n        return lists.length ? event_store_1.domainEventsByAggregate(lists[0]) : [];\n    });\n}\nexports.todoListEvents = todoListEvents;\nfunction todoLists(events) {\n    return events.reduce(function (p, c) {\n        if (c.type === event_store_1.DomainEventType.TodoAdded && p.indexOf(c.aggregateId) !== -1) {\n            p.push(c.aggregateId);\n        }\n        return p;\n    }, []);\n}\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar event_store_1 = __webpack_require__(1);\nvar utils_1 = __webpack_require__(0);\nvar todo_list_1 = __webpack_require__(9);\nvar todo_list_panel_controller_1 = __webpack_require__(7);\nvar completed_todo_list_panel_controller_1 = __webpack_require__(4);\nvar event_list_controller_1 = __webpack_require__(5);\nfunction refreshLists(todoListId) {\n    return event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n        var todoList = new todo_list_1.TodoList(events);\n        utils_1.replaceChildren(utils_1.findControllerElement(document, \"todoListPanelController\"), todo_list_panel_controller_1.todoListPanelController(todoList.todos));\n        utils_1.replaceChildren(utils_1.findControllerElement(document, \"completedTodoListPanelController\"), completed_todo_list_panel_controller_1.completedTodoListPanelController(todoList.completedTodos));\n        utils_1.replaceChildren(utils_1.findControllerElement(document, \"eventListController\"), event_list_controller_1.eventListController(events));\n    });\n}\nexports.refreshLists = refreshLists;\nfunction invalidNameInputHandler(e) {\n    var input = e.currentTarget;\n    var $input = $(input);\n    var $form = $input.closest(\"form\");\n    var $button = $input.next().children(\"button\");\n    $form.addClass(\"has-error\");\n    $button.removeClass(\"btn-success\").addClass(\"btn-danger\");\n    var validationEventNamespace = \".nameTodoInputValidation:\" + e.timeStamp.toString().replace(\".\", \"\");\n    function clearValidation() {\n        $form.removeClass(\"has-error\");\n        $button.removeClass(\"btn-danger\").addClass(\"btn-success\");\n        $form.off(validationEventNamespace);\n        $input.off(validationEventNamespace);\n    }\n    $input.on(\"input\" + validationEventNamespace, function (e) {\n        if (input.validity.valid) {\n            clearValidation();\n        }\n    });\n    $form.on(\"focusout\" + validationEventNamespace, function (e) {\n        setTimeout(function () {\n            if (!e.currentTarget.contains(document.activeElement)) {\n                clearValidation();\n            }\n        }, 0);\n    });\n}\nexports.invalidNameInputHandler = invalidNameInputHandler;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar todo_list_controller_1 = __webpack_require__(6);\nfunction completedTodoListPanelController(todos) {\n    if (!todos.length) {\n        return new DocumentFragment();\n    }\n    var fragment = utils_1.templateClone(\"completedTodoListPanelTemplate\");\n    utils_1.findControllerElement(fragment, \"todoListController\").appendChild(todo_list_controller_1.todoListController(todos));\n    return fragment;\n}\nexports.completedTodoListPanelController = completedTodoListPanelController;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction eventListController(events) {\n    if (events.length) {\n        var fragment = utils_1.templateClone(\"eventListTemplate\");\n        utils_1.setContentElement(fragment, \"eventListText\", events.reduce(function (p, c) {\n            return p + JSON.stringify(c) + \"\\n\";\n        }, \"\"));\n        return fragment;\n    } else {\n        var _fragment = utils_1.templateClone(\"emptyEventListTemplate\");\n        return _fragment;\n    }\n}\nexports.eventListController = eventListController;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar todo_list_group_controller_1 = __webpack_require__(19);\nfunction todoListController(todos) {\n    var fragment = utils_1.templateClone(\"todoListTemplate\");\n    utils_1.findControllerElement(fragment, \"todoListGroupController\").appendChild(todo_list_group_controller_1.todoListGroupController(todos));\n    return fragment;\n}\nexports.todoListController = todoListController;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar todo_list_controller_1 = __webpack_require__(6);\nfunction todoListPanelController(todos) {\n    if (!todos.length) {\n        return new DocumentFragment();\n    }\n    var fragment = utils_1.templateClone(\"todoListPanelTemplate\");\n    utils_1.findControllerElement(fragment, \"todoListController\").appendChild(todo_list_controller_1.todoListController(todos));\n    return fragment;\n}\nexports.todoListPanelController = todoListPanelController;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction todoTitleController(todo) {\n    var titleFragment = utils_1.templateClone(\"todoTitleTemplate\");\n    utils_1.setContentElement(titleFragment, \"name\", todo.name);\n    if (todo.isCompleted) {\n        var completionDateFragment = utils_1.templateClone(\"todoCompletionDateTemplate\");\n        var date = new Date(todo.completionTimestamp);\n        utils_1.setContentElement(completionDateFragment, \"completionDate\", date.toLocaleDateString());\n        titleFragment.appendChild(completionDateFragment);\n    }\n    return titleFragment;\n}\nexports.todoTitleController = todoTitleController;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar aggregate_root_1 = __webpack_require__(22);\nvar todo_1 = __webpack_require__(24);\nvar events_1 = __webpack_require__(23);\nvar uuid_1 = __webpack_require__(10);\n\nvar TodoList = function (_aggregate_root_1$Agg) {\n    _inherits(TodoList, _aggregate_root_1$Agg);\n\n    function TodoList() {\n        _classCallCheck(this, TodoList);\n\n        return _possibleConstructorReturn(this, (TodoList.__proto__ || Object.getPrototypeOf(TodoList)).apply(this, arguments));\n    }\n\n    _createClass(TodoList, [{\n        key: \"init\",\n        value: function init() {\n            _get(TodoList.prototype.__proto__ || Object.getPrototypeOf(TodoList.prototype), \"init\", this).call(this);\n            this._todos = [];\n        }\n        // Domain Event Handlers\n\n    }, {\n        key: \"TodoAdded\",\n        value: function TodoAdded(e) {\n            if (!this.id) {\n                this._id = e.aggregateId;\n            }\n            this._todos.push(new todo_1.Todo(e.todoId, e.todoName));\n        }\n    }, {\n        key: \"TodoRemoved\",\n        value: function TodoRemoved(e) {\n            var i = this._todos.findIndex(function (x) {\n                return x.id === e.todoId;\n            });\n            if (i !== -1) {\n                this._todos.splice(i, 1);\n            }\n        }\n    }, {\n        key: \"TodoCompleted\",\n        value: function TodoCompleted(e) {\n            var i = this._todos.findIndex(function (x) {\n                return x.id === e.todoId;\n            });\n            if (i !== -1) {\n                var oldTodo = this._todos[i];\n                var newTodo = new todo_1.CompletedTodo(oldTodo.id, oldTodo.name, e.todoCompletionTimestamp);\n                this._todos[i] = newTodo;\n            }\n        }\n    }, {\n        key: \"TodoUncompleted\",\n        value: function TodoUncompleted(e) {\n            var i = this._todos.findIndex(function (x) {\n                return x.id === e.todoId;\n            });\n            if (i !== -1) {\n                var oldTodo = this._todos[i];\n                var newTodo = new todo_1.Todo(oldTodo.id, oldTodo.name);\n                this._todos[i] = newTodo;\n            }\n        }\n    }, {\n        key: \"TodoRenamed\",\n        value: function TodoRenamed(e) {\n            var todo = this._todos.find(function (x) {\n                return x.id === e.todoId;\n            });\n            if (todo) {\n                todo.name = e.todoName;\n            }\n        }\n    }, {\n        key: \"TodoPositionChanged\",\n        value: function TodoPositionChanged(e) {\n            var _this2 = this;\n\n            var incompleteTodoPositions = this._todos.reduce(function (p, c, i) {\n                if (!c.isCompleted) {\n                    p.push(i);\n                }\n                return p;\n            }, new Array());\n            var from = incompleteTodoPositions.findIndex(function (x) {\n                return _this2._todos[x].id === e.todoId;\n            });\n            if (from === -1) {\n                return;\n            }\n            var to = from + e.todoOffset;\n            if (to < 0) {\n                to = 0;\n            } else if (to > incompleteTodoPositions.length - 1) {\n                to = incompleteTodoPositions.length - 1;\n            }\n            if (from === to) {\n                return;\n            }\n            if (to < from) {\n                for (var i = to; i < from; i++) {\n                    arraySwap(this._todos, incompleteTodoPositions[from], incompleteTodoPositions[i]);\n                }\n            } else {\n                for (var _i = to; _i > from; _i--) {\n                    arraySwap(this._todos, incompleteTodoPositions[from], incompleteTodoPositions[_i]);\n                }\n            }\n            function arraySwap(arr, x, y) {\n                var a = arr[x];\n                arr[x] = arr[y];\n                arr[y] = a;\n            }\n        }\n    }, {\n        key: \"add\",\n        value: function add(id, name) {\n            var agId = this.id || uuid_1.v4();\n            this.applyAndStage(new events_1.TodoAdded(agId, id, name));\n        }\n    }, {\n        key: \"remove\",\n        value: function remove(id) {\n            this.applyAndStage(new events_1.TodoRemoved(this.id, id));\n        }\n    }, {\n        key: \"complete\",\n        value: function complete(id, completionTimestamp) {\n            this.applyAndStage(new events_1.TodoCompleted(this.id, id, completionTimestamp));\n        }\n    }, {\n        key: \"uncomplete\",\n        value: function uncomplete(id) {\n            this.applyAndStage(new events_1.TodoUncompleted(this.id, id));\n        }\n    }, {\n        key: \"rename\",\n        value: function rename(id, name) {\n            this.applyAndStage(new events_1.TodoRenamed(this.id, id, name));\n        }\n    }, {\n        key: \"changePosition\",\n        value: function changePosition(id, offset) {\n            this.applyAndStage(new events_1.TodoPositionChanged(this.id, id, offset));\n        }\n    }, {\n        key: \"todos\",\n        get: function get() {\n            return this._todos.filter(function (x) {\n                return !x.isCompleted;\n            });\n        }\n    }, {\n        key: \"completedTodos\",\n        get: function get() {\n            return this._todos.filter(function (x) {\n                return x.isCompleted;\n            }).sort(function (x, y) {\n                return y.completionTimestamp - x.completionTimestamp;\n            });\n        }\n    }]);\n\n    return TodoList;\n}(aggregate_root_1.AggregateRoot);\n\nexports.TodoList = TodoList;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar v1 = __webpack_require__(26);\nvar v4 = __webpack_require__(27);\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports) {\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  return  bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\nmodule.exports = bytesToUuid;\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global) {// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\nvar rng;\n\nvar crypto = global.crypto || global.msCrypto; // for IE 11\nif (crypto && crypto.getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16);\n  rng = function whatwgRNG() {\n    crypto.getRandomValues(rnds8);\n    return rnds8;\n  };\n}\n\nif (!rng) {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var  rnds = new Array(16);\n  rng = function() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n\nmodule.exports = rng;\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(28)))\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar todo_list_panel_controller_1 = __webpack_require__(7);\nvar completed_todo_list_panel_controller_1 = __webpack_require__(4);\nvar event_list_controller_1 = __webpack_require__(5);\nvar todo_list_1 = __webpack_require__(9);\nvar event_store_1 = __webpack_require__(1);\nvar uuid_1 = __webpack_require__(10);\nvar app_common_1 = __webpack_require__(3);\nvar read_1 = __webpack_require__(2);\nfunction bodyController(events) {\n    var fragment = utils_1.templateClone(\"bodyTemplate\");\n    var todoList = new todo_list_1.TodoList(events);\n    var todoListId = todoList.id;\n    var addTodoForm = utils_1.findElement(fragment, \"#addTodoForm\");\n    var addTodoInput = utils_1.findElement(addTodoForm, \"#addTodoInput\");\n    $(addTodoInput).on(\"invalid\", app_common_1.invalidNameInputHandler);\n    $(addTodoForm).submit(function (e) {\n        e.preventDefault();\n        // This is to deal with the possibility that the user opens the app for the first time in two tabs\n        // and adds a to-do to each new TodoList. TodoList ids are generated when the first Todo is\n        // added to them. So, on first load, there are no Todos and no TodoLists, and this handler\n        // can't know whether to create a new TodoList or load one that might have been made in another tab.\n        // So, if the current TodoList has no id -- i.e. no todos have been added -- we check if any other\n        // tab has added a new TodoList and use that id.\n        var eventsPromise = todoListId ? event_store_1.domainEventsByAggregate(todoListId) : read_1.todoListEvents();\n        eventsPromise.then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            todoList.add(uuid_1.v4(), addTodoInput.value);\n            addTodoForm.reset();\n            // This assignment is only necessary when the first Todo is added to a new TodoList.\n            todoListId = todoList.id;\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return app_common_1.refreshLists(todoListId);\n        });\n    });\n    var $todoListDelegatedEventTarget = $(utils_1.findElement(fragment, \"#todolistDelegatedEventTarget\"));\n    $todoListDelegatedEventTarget.on(\"submit\", \".renameTodoForm\", function (e) {\n        e.preventDefault();\n        event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            var todoName = $(e.currentTarget).find(\"input[name='name']\").val();\n            var todoId = utils_1.getRequiredAttribute(e.currentTarget, \"data-estd-todo-id\");\n            todoList.rename(todoId, todoName);\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return app_common_1.refreshLists(todoListId);\n        });\n    });\n    // Need to handle keypress here because the completeTodoBtn is an <a> without an href,\n    // so tabbing to it and pressing enter doesn't trigger a click event like it would with a <button>.\n    // I want completeTodoBtn to act like a <button>, but it has another <button> inside of it (todoActionsBtn),\n    // so browsers and Bootstrap styling wouldn't work if it was a <button> (HTML spec says no interactive content\n    // inside interactive content). By using an <a> with no href I get the a.list-group-item Bootstrap styling.\n    $todoListDelegatedEventTarget.on(\"click keypress\", \".completeTodoBtn\", function (e) {\n        completeTodoBtnHandler(e, true);\n    });\n    $todoListDelegatedEventTarget.on(\"click keypress\", \".uncompleteTodoBtn\", function (e) {\n        completeTodoBtnHandler(e, false);\n    });\n    function completeTodoBtnHandler(e, isComplete) {\n        // only handle \"enter\" keypresses\n        if (e.type === \"keypress\" && e.which !== 13) {\n            return;\n        }\n        // short-circuit if this event has bubbled up from the todoActionsBtn (which is inside (un)complete todo buttons)\n        var todoActionsBtn = $(e.currentTarget).find(\".todoActionsBtn\")[0];\n        if (todoActionsBtn === e.target || $.contains(todoActionsBtn, e.target)) {\n            return;\n        }\n        event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            var todoId = utils_1.getRequiredAttribute(e.currentTarget, \"data-estd-todo-id\");\n            if (isComplete) {\n                todoList.complete(todoId, Date.now());\n            } else {\n                todoList.uncomplete(todoId);\n            }\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return app_common_1.refreshLists(todoListId);\n        });\n    }\n    $todoListDelegatedEventTarget.on(\"click\", \".moveTodoUpBtn\", function (e) {\n        event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            var todoId = utils_1.getRequiredAttribute(e.currentTarget, \"data-estd-todo-id\");\n            todoList.changePosition(todoId, -1);\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return app_common_1.refreshLists(todoListId);\n        });\n    });\n    $todoListDelegatedEventTarget.on(\"click\", \".moveTodoDownBtn\", function (e) {\n        event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            var todoId = utils_1.getRequiredAttribute(e.currentTarget, \"data-estd-todo-id\");\n            todoList.changePosition(todoId, 1);\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return app_common_1.refreshLists(todoListId);\n        });\n    });\n    $todoListDelegatedEventTarget.on(\"click\", \".deleteTodoBtn\", function (e) {\n        event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            var todoId = utils_1.getRequiredAttribute(e.currentTarget, \"data-estd-todo-id\");\n            todoList.remove(todoId);\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return app_common_1.refreshLists(todoListId);\n        });\n    });\n    $todoListDelegatedEventTarget.on(\"click\", \".todoActionsBtn\", function (e) {\n        var $defaultPanel = $(e.currentTarget).closest(\".todoPanelDefault\"),\n            $actionsPanel = $defaultPanel.next(),\n            $bothPanels = $defaultPanel.add($actionsPanel),\n            actionsBtnGroup = $actionsPanel.find(\".todoActionsPanelBtnGroup\")[0],\n            eventNamespace = \"click.todoActionsPanelClose:\" + e.timeStamp.toString().replace(\".\", \"\");\n        $bothPanels.toggle();\n        // This handler will close (i.e. toggle) the ActionsPanel when the user clicks anywhere in the document outside of the actionsBtnGroup.\n        // eventNamespace is unique (probably) so each instance of this handler can only detach itself.\n        $(document).on(eventNamespace, function (closeEvent) {\n            // Short-circuit when handler is triggered by event that created it.\n            // This happens because this handler is created in the todolistDelegatedEventTarget handler but attached to the document.\n            // So, when the todolistDelegatedEventTarget handler returns, the click event that triggered it will still bubble to the document.\n            if (e.originalEvent === closeEvent.originalEvent) {\n                return;\n            }\n            if (!$.contains(actionsBtnGroup, closeEvent.target)) {\n                $bothPanels.toggle();\n            }\n            $(document).off(eventNamespace);\n        });\n    });\n    $todoListDelegatedEventTarget.on(\"click\", \".renameTodoBtn\", function (e) {\n        var $actionsPanel = $(e.currentTarget).closest(\".todoActionsPanel\");\n        var $renamePanel = $actionsPanel.next();\n        $actionsPanel.add($renamePanel).toggle();\n        $renamePanel.find(\".renameTodoBtnClickFocusTarget\").first().focus();\n    });\n    $todoListDelegatedEventTarget.on(\"blur\", \".renameTodoForm\", function (e) {\n        if (!(e.relatedTarget && $.contains(e.currentTarget, e.relatedTarget))) {\n            var $renamePanel = $(e.currentTarget).closest(\".todoRenamePanel\");\n            $renamePanel.prev().prev().add($renamePanel).toggle();\n        }\n    });\n    utils_1.findControllerElement(fragment, \"todoListPanelController\").appendChild(todo_list_panel_controller_1.todoListPanelController(todoList.todos));\n    utils_1.findControllerElement(fragment, \"completedTodoListPanelController\").appendChild(completed_todo_list_panel_controller_1.completedTodoListPanelController(todoList.completedTodos));\n    utils_1.findControllerElement(fragment, \"eventListController\").appendChild(event_list_controller_1.eventListController(events));\n    return fragment;\n}\nexports.bodyController = bodyController;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__webpack_require__(14);\nvar body_controller_1 = __webpack_require__(13);\nvar utils_1 = __webpack_require__(0);\nvar read_1 = __webpack_require__(2);\nif (!window.indexedDB) {\n    window.alert(\"Your browser doesn't support IndexedDB (the browser feature this app uses to store your To-dos). Update your browser to its latest version.\");\n}\nread_1.todoListEvents().then(function (events) {\n    utils_1.findControllerElement(document, \"bodyController\").appendChild(body_controller_1.bodyController(events));\n});\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction todoActionsPanelButtonsController(todo) {\n    var fragment = utils_1.templateClone(\"todoDeleteBtnTemplate\");\n    if (!todo.isCompleted) {\n        fragment.appendChild(utils_1.templateClone(\"todoMoveUpBtnTemplate\"));\n        fragment.appendChild(utils_1.templateClone(\"todoMoveDownBtnTemplate\"));\n    }\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n        for (var _iterator = fragment.querySelectorAll(\"button\")[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var element = _step.value;\n\n            element.dataset.todoId = todo.id;\n        }\n    } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n    } finally {\n        try {\n            if (!_iteratorNormalCompletion && _iterator.return) {\n                _iterator.return();\n            }\n        } finally {\n            if (_didIteratorError) {\n                throw _iteratorError;\n            }\n        }\n    }\n\n    fragment.appendChild(utils_1.templateClone(\"todoRenameBtnTemplate\"));\n    utils_1.setPropElements(fragment, \"todo-id\", todo.id);\n    return fragment;\n}\nexports.todoActionsPanelButtonsController = todoActionsPanelButtonsController;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar todo_title_controller_1 = __webpack_require__(8);\nvar todo_actions_panel_buttons_controller_1 = __webpack_require__(16);\nfunction todoActionsPanelController(todo) {\n    var fragment = utils_1.templateClone(\"todoActionsPanelTemplate\");\n    utils_1.findControllerElement(fragment, \"todoTitleController\").appendChild(todo_title_controller_1.todoTitleController(todo));\n    utils_1.findControllerElement(fragment, \"todoActionsPanelButtonsController\").appendChild(todo_actions_panel_buttons_controller_1.todoActionsPanelButtonsController(todo));\n    return fragment;\n}\nexports.todoActionsPanelController = todoActionsPanelController;\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar todo_title_panel_controller_1 = __webpack_require__(21);\nvar todo_actions_panel_controller_1 = __webpack_require__(17);\nvar todo_rename_panel_controller_1 = __webpack_require__(20);\nfunction todoController(todo) {\n    var fragment = todo.isCompleted ? utils_1.templateClone(\"completedTodoTemplate\") : utils_1.templateClone(\"todoTemplate\");\n    utils_1.setPropElements(fragment, \"todo-id\", todo.id);\n    utils_1.findControllerElement(fragment, \"todoTitlePanelController\").appendChild(todo_title_panel_controller_1.todoTitlePanelController(todo));\n    utils_1.findControllerElement(fragment, \"todoActionsPanelController\").appendChild(todo_actions_panel_controller_1.todoActionsPanelController(todo));\n    utils_1.findControllerElement(fragment, \"todoRenamePanelController\").appendChild(todo_rename_panel_controller_1.todoRenamePanelController(todo));\n    return fragment;\n}\nexports.todoController = todoController;\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar todo_controller_1 = __webpack_require__(18);\nfunction todoListGroupController(todos) {\n    var fragment = new DocumentFragment();\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n        for (var _iterator = todos[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var todo = _step.value;\n\n            fragment.appendChild(todo_controller_1.todoController(todo));\n        }\n    } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n    } finally {\n        try {\n            if (!_iteratorNormalCompletion && _iterator.return) {\n                _iterator.return();\n            }\n        } finally {\n            if (_didIteratorError) {\n                throw _iteratorError;\n            }\n        }\n    }\n\n    return fragment;\n}\nexports.todoListGroupController = todoListGroupController;\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar app_common_1 = __webpack_require__(3);\nfunction todoRenamePanelController(todo) {\n    var fragment = utils_1.templateClone(\"todoRenamePanelTemplate\");\n    var input = utils_1.findElement(fragment, \"input[name='name']\");\n    var inputId = input.getAttribute(\"id\");\n    var newInputId = inputId + \"-\" + todo.id;\n    var label = utils_1.findElement(fragment, \"label[for='\" + inputId + \"']\");\n    input.setAttribute(\"id\", newInputId);\n    input.setAttribute(\"value\", todo.name);\n    label.setAttribute(\"for\", newInputId);\n    utils_1.setPropElements(fragment, \"todo-id\", todo.id);\n    $(input).on(\"invalid\", app_common_1.invalidNameInputHandler);\n    return fragment;\n}\nexports.todoRenamePanelController = todoRenamePanelController;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar todo_title_controller_1 = __webpack_require__(8);\nfunction todoTitlePanelController(todo) {\n    var fragment = utils_1.templateClone(\"todoTitlePanelTemplate\");\n    utils_1.findControllerElement(fragment, \"todoTitleController\").appendChild(todo_title_controller_1.todoTitleController(todo));\n    return fragment;\n}\nexports.todoTitlePanelController = todoTitlePanelController;\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar event_store_1 = __webpack_require__(1);\n\nvar AggregateRoot = function () {\n    _createClass(AggregateRoot, [{\n        key: \"init\",\n        value: function init() {\n            this._uncommittedEvents = new Array();\n        }\n    }, {\n        key: \"uncommittedEvents\",\n        get: function get() {\n            return this._uncommittedEvents;\n        }\n    }, {\n        key: \"id\",\n        get: function get() {\n            return this._id;\n        }\n    }]);\n\n    function AggregateRoot(events) {\n        var _this = this;\n\n        _classCallCheck(this, AggregateRoot);\n\n        this.init();\n        events.forEach(function (e) {\n            _this[event_store_1.DomainEventType[e.type]](e);\n        });\n    }\n\n    _createClass(AggregateRoot, [{\n        key: \"applyAndStage\",\n        value: function applyAndStage(e) {\n            this[event_store_1.DomainEventType[e.type]](e);\n            this._uncommittedEvents.push(e);\n        }\n    }]);\n\n    return AggregateRoot;\n}();\n\nexports.AggregateRoot = AggregateRoot;\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar event_store_1 = __webpack_require__(1);\n\nvar TodoAdded = function TodoAdded(aggregateId, todoId, todoName) {\n    _classCallCheck(this, TodoAdded);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.todoName = todoName;\n    this.type = event_store_1.DomainEventType.TodoAdded;\n};\n\nexports.TodoAdded = TodoAdded;\n\nvar TodoRemoved = function TodoRemoved(aggregateId, todoId) {\n    _classCallCheck(this, TodoRemoved);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.type = event_store_1.DomainEventType.TodoRemoved;\n};\n\nexports.TodoRemoved = TodoRemoved;\n\nvar TodoCompleted = function TodoCompleted(aggregateId, todoId, todoCompletionTimestamp) {\n    _classCallCheck(this, TodoCompleted);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.todoCompletionTimestamp = todoCompletionTimestamp;\n    this.type = event_store_1.DomainEventType.TodoCompleted;\n};\n\nexports.TodoCompleted = TodoCompleted;\n\nvar TodoUncompleted = function TodoUncompleted(aggregateId, todoId) {\n    _classCallCheck(this, TodoUncompleted);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.type = event_store_1.DomainEventType.TodoUncompleted;\n};\n\nexports.TodoUncompleted = TodoUncompleted;\n\nvar TodoRenamed = function TodoRenamed(aggregateId, todoId, todoName) {\n    _classCallCheck(this, TodoRenamed);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.todoName = todoName;\n    this.type = event_store_1.DomainEventType.TodoRenamed;\n};\n\nexports.TodoRenamed = TodoRenamed;\n\nvar TodoPositionChanged = function TodoPositionChanged(aggregateId, todoId, todoOffset) {\n    _classCallCheck(this, TodoPositionChanged);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.todoOffset = todoOffset;\n    this.type = event_store_1.DomainEventType.TodoPositionChanged;\n};\n\nexports.TodoPositionChanged = TodoPositionChanged;\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\nvar Todo = function Todo(id, name) {\n    _classCallCheck(this, Todo);\n\n    this.id = id;\n    this.name = name;\n    this.isCompleted = false;\n};\n\nexports.Todo = Todo;\n\nvar CompletedTodo = function (_Todo) {\n    _inherits(CompletedTodo, _Todo);\n\n    function CompletedTodo(id, name, completionTimestamp) {\n        _classCallCheck(this, CompletedTodo);\n\n        var _this = _possibleConstructorReturn(this, (CompletedTodo.__proto__ || Object.getPrototypeOf(CompletedTodo)).call(this, id, name));\n\n        _this.completionTimestamp = completionTimestamp;\n        _this.isCompleted = true;\n        return _this;\n    }\n\n    return CompletedTodo;\n}(Todo);\n\nexports.CompletedTodo = CompletedTodo;\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      request.onupgradeneeded = function(event) {\n        if (upgradeCallback) {\n          upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n        }\n      };\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (true) {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// Unique ID creation requires a high quality random # generator.  We feature\n// detect to determine the best RNG source, normalizing to a function that\n// returns 128-bits of randomness, since that's what's usually required\nvar rng = __webpack_require__(12);\nvar bytesToUuid = __webpack_require__(11);\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\n// random #'s we need to init node and clockseq\nvar _seedBytes = rng();\n\n// Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\nvar _nodeId = [\n  _seedBytes[0] | 0x01,\n  _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n];\n\n// Per 4.2.2, randomize (14 bit) clockseq\nvar _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n// Previous uuid creation time\nvar _lastMSecs = 0, _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  var node = options.node || _nodeId;\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar rng = __webpack_require__(12);\nvar bytesToUuid = __webpack_require__(11);\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options == 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports) {\n\nvar g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.458567671bc6624d8b8a.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap fc4e4203504d7cca54d0","export function templateClone(id: string): DocumentFragment {\r\n    let selector = \"template#\" + id;\r\n    let template = document.querySelector(selector) as HTMLTemplateElement | null;\r\n    if (!template) {\r\n        throw new Error(`Document missing required '${selector}' element`);\r\n    }\r\n    let fragment = document.importNode(template.content, true);\r\n    return fragment;\r\n}\r\n\r\nexport function findControllerElement(parentNode: NodeSelector, controllerName: string): HTMLElement {\r\n    let selector = `[data-estd-controller='${controllerName}']`;\r\n    return findElement(parentNode, selector) as HTMLElement;\r\n}\r\n\r\nexport function setContentElement(parentNode: NodeSelector, propName: string, content: string): void {\r\n    findContentElements(parentNode, propName).forEach(elem => elem.textContent = content);\r\n}\r\n\r\nfunction findContentElements(parentNode: NodeSelector, propName: string): NodeListOf<HTMLElement> {\r\n    let selector = `[data-estd-content='${propName}']`;\r\n    return findAllElements(parentNode, selector) as NodeListOf<HTMLElement>;\r\n}\r\n\r\nexport function setPropElements(parentNode: NodeSelector, propName: string, value: string): void {\r\n    let attributeName = \"data-estd-\" + propName;\r\n    findPropElements(parentNode, propName).forEach(elem => elem.setAttribute(attributeName, value));\r\n}\r\n\r\nfunction findPropElements(parentNode: NodeSelector, propName: string): NodeListOf<HTMLElement> {\r\n    let selector = `[data-estd-prop='${propName}']`;\r\n    return findAllElements(parentNode, selector) as NodeListOf<HTMLElement>;\r\n}\r\n\r\nexport function findElement(parentNode: NodeSelector, selector: string) {\r\n    let element = parentNode.querySelector(selector);\r\n    if (!element) {\r\n        throw new Error(`'${parentNode}' missing required '${selector}' element`);\r\n    }\r\n    return element;\r\n}\r\n\r\nfunction findAllElements(parentNode: NodeSelector, selector: string) {\r\n    let elements = parentNode.querySelectorAll(selector);\r\n    if (!elements.length) {\r\n        throw new Error(`'${parentNode}' missing required '${selector}' element`);\r\n    }\r\n    return elements;\r\n}\r\n\r\nexport function replaceChildren(parent: HTMLElement, newNode: Node): void {\r\n    parent.innerHTML = \"\";\r\n    parent.appendChild(newNode);\r\n}\r\n\r\nexport function getRequiredAttribute(element: Element, attributeName: string): string {\r\n    let value = element.getAttribute(attributeName);\r\n    if (!value) {\r\n        throw new Error(`'${element}' missing required '${attributeName}' attribute`);\r\n    }\r\n    return value;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./utils.ts","import idb, { DB } from \"idb\";\r\n\r\nexport enum DomainEventType {\r\n    TodoAdded,\r\n    TodoRemoved,\r\n    TodoCompleted,\r\n    TodoUncompleted,\r\n    TodoRenamed,\r\n    TodoPositionChanged\r\n}\r\nexport type AggregateIdType = string;\r\nexport interface UncommittedDomainEvent {\r\n    readonly aggregateId: AggregateIdType;\r\n    readonly type: DomainEventType;\r\n}\r\nexport interface DomainEvent extends UncommittedDomainEvent {\r\n    readonly id: number;\r\n}\r\nexport interface EventStore {\r\n    getAllDomainEvents(version?: number): Promise<DomainEvent[]>;\r\n    getDomainEventsByAggregate(aggregateId: AggregateIdType, version?: number): Promise<DomainEvent[]>;\r\n    postDomainEvents(events: UncommittedDomainEvent[]): Promise<void>;\r\n}\r\n\r\nconst dbName = \"estd-db\";\r\nconst domainEventStoreName = \"domain-event\";\r\nconst aggregateIdPropName = \"aggregateId\";\r\nconst eventIdPropName = \"id\";\r\n\r\nfunction open(): Promise<DB> {\r\n    return idb.open(dbName, 1, db => {\r\n        switch (db.oldVersion) {\r\n            case 0:\r\n                db.createObjectStore(domainEventStoreName, { autoIncrement: true, keyPath: eventIdPropName })\r\n                    .createIndex(aggregateIdPropName, aggregateIdPropName);\r\n        }\r\n    }).catch(reason => {\r\n        alert(\"Database error: \" + reason);\r\n    });\r\n}\r\nexport function allDomainEvents(version?: number): Promise<DomainEvent[]> {\r\n    return open().then(db => {\r\n        let store = db.transaction(domainEventStoreName).objectStore(domainEventStoreName);\r\n        return (version)\r\n            ? store.getAll(IDBKeyRange.upperBound(version))\r\n            : store.getAll();\r\n    }).catch(reason => {\r\n        alert(\"Database error: \" + reason);\r\n    });\r\n}\r\nexport function domainEventsByAggregate(aggregateId: AggregateIdType, version?: number): Promise<DomainEvent[]> {\r\n    return open().then(db => {\r\n        let index = db.transaction(domainEventStoreName).objectStore(domainEventStoreName).index(aggregateIdPropName);\r\n        let eventsPromise = index.getAll(aggregateId) as Promise<DomainEvent[]>;\r\n        return (version)\r\n            ? eventsPromise.then(events => events.filter(e => e.id <= version))\r\n            : eventsPromise;\r\n    }).catch(reason => {\r\n        alert(\"Database error: \" + reason);\r\n    });\r\n}\r\nexport function postDomainEvents(events: UncommittedDomainEvent[]): Promise<void> {\r\n    return open().then(db => {\r\n        let tx = db.transaction(domainEventStoreName, \"readwrite\");\r\n        let store = tx.objectStore(domainEventStoreName);\r\n        events.forEach(x => store.add(x));\r\n        return tx.complete;\r\n    }).catch(reason => {\r\n        alert(\"Database error: \" + reason);\r\n    });\r\n}\n\n\n// WEBPACK FOOTER //\n// ./event-store.ts","import { AggregateIdType, DomainEvent, DomainEventType, allDomainEvents, domainEventsByAggregate } from \"./event-store\";\r\n\r\nexport function todoListEvents(): Promise<DomainEvent[]> {\r\n    // This app's domain and event-store are designed to accommodate multiple aggregates of different types.\r\n    // Currently, the app only has one aggregate type (TodoList) and only allows the user to have one instance of that aggregate.\r\n    // This todoLists() lookup occurs to get the aggreateId of the user's one TodoList.\r\n    return allDomainEvents()\r\n        .then(events => {\r\n            let lists = todoLists(events);\r\n            return (lists.length)\r\n                ? domainEventsByAggregate(lists[0])\r\n                : [];\r\n        })\r\n}\r\n\r\nfunction todoLists(events: DomainEvent[]): AggregateIdType[] {\r\n    return events.reduce<AggregateIdType[]>((p, c) => {\r\n        if (c.type === DomainEventType.TodoAdded && p.indexOf(c.aggregateId) !== -1) {\r\n            p.push(c.aggregateId);\r\n        }\r\n        return p;\r\n    }, []);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./read.ts","import { allDomainEvents, AggregateIdType, domainEventsByAggregate } from \"./event-store\";\r\nimport { replaceChildren, findControllerElement } from \"./utils\";\r\nimport { TodoList } from \"./domain/todo-list\";\r\nimport { todoListPanelController } from \"./controllers/todo-list-panel-controller\";\r\nimport { completedTodoListPanelController } from \"./controllers/completed-todo-list-panel-controller\";\r\nimport { eventListController } from \"./controllers/event-list-controller\";\r\nimport { todoListEvents } from \"./read\";\r\nimport { bodyController } from \"./controllers/body-controller\";\r\n\r\nexport function refreshLists(todoListId: AggregateIdType): Promise<void> {\r\n    return domainEventsByAggregate(todoListId)\r\n        .then(events => {\r\n            let todoList = new TodoList(events);\r\n            replaceChildren(findControllerElement(document, \"todoListPanelController\"), todoListPanelController(todoList.todos));\r\n            replaceChildren(findControllerElement(document, \"completedTodoListPanelController\"), completedTodoListPanelController(todoList.completedTodos));\r\n            replaceChildren(findControllerElement(document, \"eventListController\"), eventListController(events));\r\n        });\r\n}\r\n\r\nexport function invalidNameInputHandler(e: JQueryEventObject) {\r\n    let input = e.currentTarget as HTMLInputElement;\r\n    let $input = $(input);\r\n    let $form = $input.closest(\"form\");\r\n    let $button = $input.next().children(\"button\");\r\n    $form.addClass(\"has-error\");\r\n    $button.removeClass(\"btn-success\").addClass(\"btn-danger\");\r\n\r\n    let validationEventNamespace = \".nameTodoInputValidation:\" + e.timeStamp.toString().replace(\".\", \"\");\r\n    function clearValidation() {\r\n        $form.removeClass(\"has-error\");\r\n        $button.removeClass(\"btn-danger\").addClass(\"btn-success\");\r\n        $form.off(validationEventNamespace);\r\n        $input.off(validationEventNamespace);\r\n    }\r\n    $input.on(\"input\" + validationEventNamespace, function (e) {\r\n        if (input.validity.valid) {\r\n            clearValidation();\r\n        }\r\n    });\r\n    $form.on(\"focusout\" + validationEventNamespace, function (e) {\r\n        setTimeout(function () {\r\n            if (!e.currentTarget.contains(document.activeElement)) {\r\n                clearValidation();\r\n            }\r\n        }, 0);\r\n    });\r\n}\n\n\n// WEBPACK FOOTER //\n// ./app.common.ts","import { CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, findControllerElement } from \"../utils\";\r\nimport { todoListController } from \"./todo-list-controller\";\r\n\r\nexport function completedTodoListPanelController(todos: CompletedTodo[]): DocumentFragment {\r\n    if (!todos.length) {\r\n        return new DocumentFragment();\r\n    }\r\n    let fragment = templateClone(\"completedTodoListPanelTemplate\");\r\n    findControllerElement(fragment, \"todoListController\")\r\n        .appendChild(todoListController(todos));\r\n    return fragment;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/completed-todo-list-panel-controller.ts","import { templateClone, setContentElement } from \"../utils\";\r\nimport { DomainEvent } from \"../event-store\";\r\n\r\nexport function eventListController(events: DomainEvent[]): DocumentFragment {\r\n    if (events.length) {\r\n        let fragment = templateClone(\"eventListTemplate\");\r\n        setContentElement(fragment, \"eventListText\", events.reduce<string>((p, c) => { return p + JSON.stringify(c) + \"\\n\"; }, \"\"));\r\n        return fragment;\r\n    } else {\r\n        let fragment = templateClone(\"emptyEventListTemplate\");\r\n        return fragment;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/event-list-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, findControllerElement } from \"../utils\";\r\nimport { todoListGroupController } from \"./todo-list-group-controller\";\r\n\r\nexport function todoListController(todos: (Todo | CompletedTodo)[]): DocumentFragment {\r\n    let fragment = templateClone(\"todoListTemplate\");\r\n    findControllerElement(fragment, \"todoListGroupController\")\r\n        .appendChild(todoListGroupController(todos));\r\n    return fragment;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-list-controller.ts","import { Todo } from \"../domain/todo\";\r\nimport { templateClone, findControllerElement } from \"../utils\";\r\nimport { todoListController } from \"./todo-list-controller\";\r\n\r\nexport function todoListPanelController(todos: Todo[]): DocumentFragment {\r\n    if (!todos.length) {\r\n        return new DocumentFragment();\r\n    }\r\n    let fragment = templateClone(\"todoListPanelTemplate\");\r\n    findControllerElement(fragment, \"todoListController\")\r\n        .appendChild(todoListController(todos));\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-list-panel-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, setContentElement } from \"../utils\";\r\n\r\nexport function todoTitleController(todo: Todo | CompletedTodo): DocumentFragment {\r\n    let titleFragment = templateClone(\"todoTitleTemplate\");\r\n    setContentElement(titleFragment, \"name\", todo.name);\r\n    if (todo.isCompleted) {\r\n        let completionDateFragment = templateClone(\"todoCompletionDateTemplate\");\r\n        let date = new Date((todo as CompletedTodo).completionTimestamp);\r\n        setContentElement(completionDateFragment, \"completionDate\", date.toLocaleDateString());\r\n        titleFragment.appendChild(completionDateFragment);\r\n    }\r\n    return titleFragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-title-controller.ts","import { AggregateRoot } from \"./aggregate-root\";\r\nimport { Todo, CompletedTodo, TodoIdType } from \"./todo\";\r\nimport { TodoAdded, TodoRemoved, TodoCompleted, TodoUncompleted, TodoRenamed, TodoPositionChanged } from \"./events\";\r\nimport { v4 as uuid } from \"uuid\";\r\n\r\nexport class TodoList extends AggregateRoot {\r\n    protected _todos: (Todo | CompletedTodo)[];\r\n    get todos(): Todo[] {\r\n        return this._todos.filter(x => !x.isCompleted);\r\n    }\r\n    get completedTodos(): CompletedTodo[] {\r\n        return (this._todos.filter(x => x.isCompleted) as CompletedTodo[])\r\n            .sort((x, y) => {\r\n                return y.completionTimestamp - x.completionTimestamp\r\n            });\r\n    }\r\n    protected init(): void {\r\n        super.init();\r\n        this._todos = [];\r\n    }\r\n\r\n    // Domain Event Handlers\r\n    protected TodoAdded(e: TodoAdded): void {\r\n        if (!this.id) {\r\n            this._id = e.aggregateId;\r\n        }\r\n        this._todos.push(new Todo(e.todoId, e.todoName))\r\n    }\r\n    protected TodoRemoved(e: TodoRemoved): void {\r\n        let i = this._todos.findIndex(x => x.id === e.todoId);\r\n        if (i !== -1) {\r\n            this._todos.splice(i, 1)\r\n        }\r\n    }\r\n    protected TodoCompleted(e: TodoCompleted): void {\r\n        let i = this._todos.findIndex(x => x.id === e.todoId);\r\n        if (i !== -1) {\r\n            let oldTodo = this._todos[i];\r\n            let newTodo = new CompletedTodo(oldTodo.id, oldTodo.name, e.todoCompletionTimestamp);\r\n            this._todos[i] = newTodo;\r\n        }\r\n    }\r\n    protected TodoUncompleted(e: TodoUncompleted): void {\r\n        let i = this._todos.findIndex(x => x.id === e.todoId);\r\n        if (i !== -1) {\r\n            let oldTodo = this._todos[i];\r\n            let newTodo = new Todo(oldTodo.id, oldTodo.name);\r\n            this._todos[i] = newTodo;\r\n        }\r\n    }\r\n    protected TodoRenamed(e: TodoRenamed): void {\r\n        let todo = this._todos.find(x => x.id === e.todoId);\r\n        if (todo) {\r\n            todo.name = e.todoName;\r\n        }\r\n    }\r\n    protected TodoPositionChanged(e: TodoPositionChanged): void {\r\n        let incompleteTodoPositions: number[] = this._todos.reduce<number[]>((p, c, i) => {\r\n            if (!c.isCompleted) {\r\n                p.push(i);\r\n            }\r\n            return p;\r\n        }, new Array<number>());\r\n        let from = incompleteTodoPositions.findIndex(x => this._todos[x].id === e.todoId);\r\n        if (from === -1) {\r\n            return;\r\n        }\r\n        let to = from + e.todoOffset;\r\n        if (to < 0) {\r\n            to = 0;\r\n        } else if (to > incompleteTodoPositions.length - 1) {\r\n            to = incompleteTodoPositions.length - 1;\r\n        }\r\n        if (from === to) {\r\n            return;\r\n        }\r\n        if (to < from) {\r\n            for (let i = to; i < from; i++) {\r\n                arraySwap(this._todos, incompleteTodoPositions[from], incompleteTodoPositions[i]);\r\n            }\r\n        } else {\r\n            for (let i = to; i > from; i--) {\r\n                arraySwap(this._todos, incompleteTodoPositions[from], incompleteTodoPositions[i]);\r\n            }\r\n        }\r\n        function arraySwap(arr: Array<any>, x: number, y: number) {\r\n            let a = arr[x];\r\n            arr[x] = arr[y];\r\n            arr[y] = a;\r\n        }\r\n    }\r\n\r\n    add(id: TodoIdType, name: string) {\r\n        let agId = this.id || uuid();\r\n        this.applyAndStage(new TodoAdded(agId, id, name));\r\n    }\r\n    remove(id: TodoIdType) {\r\n        this.applyAndStage(new TodoRemoved(this.id, id));\r\n    }\r\n    complete(id: TodoIdType, completionTimestamp: number) {\r\n        this.applyAndStage(new TodoCompleted(this.id, id, completionTimestamp));\r\n    }\r\n    uncomplete(id: TodoIdType) {\r\n        this.applyAndStage(new TodoUncompleted(this.id, id));\r\n    }\r\n    rename(id: TodoIdType, name: string) {\r\n        this.applyAndStage(new TodoRenamed(this.id, id, name));\r\n    }\r\n    changePosition(id: TodoIdType, offset: number) {\r\n        this.applyAndStage(new TodoPositionChanged(this.id, id, offset));\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./domain/todo-list.ts","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/uuid/index.js\n// module id = 10\n// module chunks = 0","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  return  bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\nmodule.exports = bytesToUuid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/uuid/lib/bytesToUuid.js\n// module id = 11\n// module chunks = 0","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\nvar rng;\n\nvar crypto = global.crypto || global.msCrypto; // for IE 11\nif (crypto && crypto.getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16);\n  rng = function whatwgRNG() {\n    crypto.getRandomValues(rnds8);\n    return rnds8;\n  };\n}\n\nif (!rng) {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var  rnds = new Array(16);\n  rng = function() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n\nmodule.exports = rng;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/uuid/lib/rng-browser.js\n// module id = 12\n// module chunks = 0","import { templateClone, findControllerElement, findElement, getRequiredAttribute } from \"../utils\";\r\nimport { todoListPanelController } from \"./todo-list-panel-controller\";\r\nimport { completedTodoListPanelController } from \"./completed-todo-list-panel-controller\";\r\nimport { eventListController } from \"./event-list-controller\";\r\nimport { TodoList } from \"../domain/todo-list\";\r\nimport { DomainEvent, allDomainEvents, postDomainEvents, domainEventsByAggregate } from \"../event-store\";\r\nimport { v4 as uuid } from \"uuid\";\r\nimport { refreshLists, invalidNameInputHandler } from \"../app.common\";\r\nimport { todoListEvents } from \"../read\";\r\n\r\nexport function bodyController(events: DomainEvent[]): DocumentFragment {\r\n    let fragment = templateClone(\"bodyTemplate\");\r\n    let todoList = new TodoList(events);\r\n    let todoListId = todoList.id;\r\n    let addTodoForm = findElement(fragment, \"#addTodoForm\") as HTMLFormElement;\r\n    let addTodoInput = findElement(addTodoForm, \"#addTodoInput\") as HTMLInputElement;\r\n    $(addTodoInput).on(\"invalid\", invalidNameInputHandler);\r\n    $(addTodoForm).submit(function (e) {\r\n        e.preventDefault();\r\n        // This is to deal with the possibility that the user opens the app for the first time in two tabs\r\n        // and adds a to-do to each new TodoList. TodoList ids are generated when the first Todo is\r\n        // added to them. So, on first load, there are no Todos and no TodoLists, and this handler\r\n        // can't know whether to create a new TodoList or load one that might have been made in another tab.\r\n        // So, if the current TodoList has no id -- i.e. no todos have been added -- we check if any other\r\n        // tab has added a new TodoList and use that id.\r\n        let eventsPromise = (todoListId)\r\n            ? domainEventsByAggregate(todoListId)\r\n            : todoListEvents();\r\n        eventsPromise.then((events) => {\r\n            let todoList = new TodoList(events);\r\n            todoList.add(uuid(), addTodoInput.value);\r\n            addTodoForm.reset();\r\n            // This assignment is only necessary when the first Todo is added to a new TodoList.\r\n            todoListId = todoList.id;\r\n            return postDomainEvents(todoList.uncommittedEvents);\r\n        }).then(() => refreshLists(todoListId));\r\n    });\r\n    let $todoListDelegatedEventTarget = $(findElement(fragment, \"#todolistDelegatedEventTarget\"));\r\n    $todoListDelegatedEventTarget.on(\"submit\", \".renameTodoForm\", function (e) {\r\n        e.preventDefault();\r\n        domainEventsByAggregate(todoListId)\r\n            .then(events => {\r\n                let todoList = new TodoList(events);\r\n                let todoName = $(e.currentTarget).find(\"input[name='name']\").val();\r\n                let todoId = getRequiredAttribute(e.currentTarget, \"data-estd-todo-id\");\r\n                todoList.rename(todoId, todoName);\r\n                return postDomainEvents(todoList.uncommittedEvents);\r\n            }).then(() => refreshLists(todoListId));\r\n    });\r\n    // Need to handle keypress here because the completeTodoBtn is an <a> without an href,\r\n    // so tabbing to it and pressing enter doesn't trigger a click event like it would with a <button>.\r\n    // I want completeTodoBtn to act like a <button>, but it has another <button> inside of it (todoActionsBtn),\r\n    // so browsers and Bootstrap styling wouldn't work if it was a <button> (HTML spec says no interactive content\r\n    // inside interactive content). By using an <a> with no href I get the a.list-group-item Bootstrap styling.\r\n    $todoListDelegatedEventTarget.on(\"click keypress\", \".completeTodoBtn\", function (e) {\r\n        completeTodoBtnHandler(e, true);\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"click keypress\", \".uncompleteTodoBtn\", function (e) {\r\n        completeTodoBtnHandler(e, false);\r\n    });\r\n    function completeTodoBtnHandler(e: JQueryEventObject, isComplete: boolean): void {\r\n        // only handle \"enter\" keypresses\r\n        if (e.type === \"keypress\" && e.which !== 13) {\r\n            return;\r\n        }\r\n        // short-circuit if this event has bubbled up from the todoActionsBtn (which is inside (un)complete todo buttons)\r\n        var todoActionsBtn = $(e.currentTarget).find(\".todoActionsBtn\")[0];\r\n        if (todoActionsBtn === e.target || $.contains(todoActionsBtn, e.target)) {\r\n            return;\r\n        }\r\n        domainEventsByAggregate(todoListId)\r\n            .then(events => {\r\n                let todoList = new TodoList(events);\r\n                let todoId = getRequiredAttribute(e.currentTarget, \"data-estd-todo-id\");\r\n                if (isComplete) {\r\n                    todoList.complete(todoId, Date.now());\r\n                } else {\r\n                    todoList.uncomplete(todoId);\r\n                }\r\n                return postDomainEvents(todoList.uncommittedEvents);\r\n            }).then(() => refreshLists(todoListId));\r\n    }\r\n    $todoListDelegatedEventTarget.on(\"click\", \".moveTodoUpBtn\", function (e) {\r\n        domainEventsByAggregate(todoListId)\r\n            .then(events => {\r\n                let todoList = new TodoList(events);\r\n                let todoId = getRequiredAttribute(e.currentTarget, \"data-estd-todo-id\");\r\n                todoList.changePosition(todoId, -1);\r\n                return postDomainEvents(todoList.uncommittedEvents);\r\n            }).then(() => refreshLists(todoListId));\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"click\", \".moveTodoDownBtn\", function (e) {\r\n        domainEventsByAggregate(todoListId)\r\n            .then(events => {\r\n                let todoList = new TodoList(events);\r\n                let todoId = getRequiredAttribute(e.currentTarget, \"data-estd-todo-id\");\r\n                todoList.changePosition(todoId, 1);\r\n                return postDomainEvents(todoList.uncommittedEvents);\r\n            }).then(() => refreshLists(todoListId));\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"click\", \".deleteTodoBtn\", function (e) {\r\n        domainEventsByAggregate(todoListId)\r\n            .then(events => {\r\n                let todoList = new TodoList(events);\r\n                let todoId = getRequiredAttribute(e.currentTarget, \"data-estd-todo-id\");\r\n                todoList.remove(todoId);\r\n                return postDomainEvents(todoList.uncommittedEvents);\r\n            }).then(() => refreshLists(todoListId));\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"click\", \".todoActionsBtn\", function (e) {\r\n        var $defaultPanel = $(e.currentTarget).closest(\".todoPanelDefault\"),\r\n            $actionsPanel = $defaultPanel.next(),\r\n            $bothPanels = $defaultPanel.add($actionsPanel),\r\n            actionsBtnGroup = $actionsPanel.find(\".todoActionsPanelBtnGroup\")[0],\r\n            eventNamespace = \"click.todoActionsPanelClose:\" + e.timeStamp.toString().replace(\".\", \"\");\r\n        $bothPanels.toggle();\r\n\r\n        // This handler will close (i.e. toggle) the ActionsPanel when the user clicks anywhere in the document outside of the actionsBtnGroup.\r\n        // eventNamespace is unique (probably) so each instance of this handler can only detach itself.\r\n        $(document).on(eventNamespace, function (closeEvent) {\r\n            // Short-circuit when handler is triggered by event that created it.\r\n            // This happens because this handler is created in the todolistDelegatedEventTarget handler but attached to the document.\r\n            // So, when the todolistDelegatedEventTarget handler returns, the click event that triggered it will still bubble to the document.\r\n            if (e.originalEvent === closeEvent.originalEvent) {\r\n                return;\r\n            }\r\n            if (!$.contains(actionsBtnGroup, closeEvent.target)) {\r\n                $bothPanels.toggle();\r\n            }\r\n            $(document).off(eventNamespace);\r\n        });\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"click\", \".renameTodoBtn\", function (e) {\r\n        var $actionsPanel = $(e.currentTarget).closest(\".todoActionsPanel\");\r\n        var $renamePanel = $actionsPanel.next();\r\n        $actionsPanel.add($renamePanel).toggle();\r\n        $renamePanel.find(\".renameTodoBtnClickFocusTarget\").first().focus();\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"blur\", \".renameTodoForm\", function (e) {\r\n        if (!(e.relatedTarget && $.contains(e.currentTarget, e.relatedTarget))) {\r\n            var $renamePanel = $(e.currentTarget).closest(\".todoRenamePanel\");\r\n            $renamePanel.prev().prev().add($renamePanel).toggle();\r\n        }\r\n    });\r\n\r\n    findControllerElement(fragment, \"todoListPanelController\")\r\n        .appendChild(todoListPanelController(todoList.todos));\r\n    findControllerElement(fragment, \"completedTodoListPanelController\")\r\n        .appendChild(completedTodoListPanelController(todoList.completedTodos));\r\n    findControllerElement(fragment, \"eventListController\")\r\n        .appendChild(eventListController(events));\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/body-controller.ts","import \"./site.css\";\r\nimport { allDomainEvents, domainEventsByAggregate } from \"./event-store\";\r\nimport { bodyController } from \"./controllers/body-controller\";\r\nimport { findControllerElement } from \"./utils\";\r\nimport { todoListEvents } from \"./read\";\r\n\r\nif (!window.indexedDB) {\r\n    window.alert(\"Your browser doesn't support IndexedDB (the browser feature this app uses to store your To-dos). Update your browser to its latest version.\");\r\n}\r\n\r\ntodoListEvents()\r\n    .then(events => {\r\n        findControllerElement(document, \"bodyController\")\r\n            .appendChild(bodyController(events));\r\n    });\n\n\n// WEBPACK FOOTER //\n// ./app.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, setPropElements } from \"../utils\";\r\n\r\nexport function todoActionsPanelButtonsController(todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = templateClone(\"todoDeleteBtnTemplate\");\r\n    if (!todo.isCompleted) {\r\n        fragment.appendChild(templateClone(\"todoMoveUpBtnTemplate\"));\r\n        fragment.appendChild(templateClone(\"todoMoveDownBtnTemplate\"));\r\n    }\r\n    for (const element of fragment.querySelectorAll(\"button\")) {\r\n        element.dataset.todoId = todo.id;\r\n    }\r\n    fragment.appendChild(templateClone(\"todoRenameBtnTemplate\"));\r\n    setPropElements(fragment, \"todo-id\", todo.id);\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-actions-panel-buttons-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, findControllerElement } from \"../utils\";\r\nimport { todoTitleController } from \"./todo-title-controller\";\r\nimport { todoActionsPanelButtonsController } from \"./todo-actions-panel-buttons-controller\";\r\n\r\nexport function todoActionsPanelController(todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = templateClone(\"todoActionsPanelTemplate\");\r\n    findControllerElement(fragment, \"todoTitleController\")\r\n        .appendChild(todoTitleController(todo));\r\n    findControllerElement(fragment, \"todoActionsPanelButtonsController\")\r\n        .appendChild(todoActionsPanelButtonsController(todo));\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-actions-panel-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, findControllerElement, setPropElements } from \"../utils\";\r\nimport { todoTitlePanelController } from \"./todo-title-panel-controller\";\r\nimport { todoActionsPanelController } from \"./todo-actions-panel-controller\";\r\nimport { todoRenamePanelController } from \"./todo-rename-panel-controller\";\r\n\r\nexport function todoController(todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = (todo.isCompleted)\r\n        ? templateClone(\"completedTodoTemplate\")\r\n        : templateClone(\"todoTemplate\");\r\n    setPropElements(fragment, \"todo-id\", todo.id);\r\n    findControllerElement(fragment, \"todoTitlePanelController\")\r\n        .appendChild(todoTitlePanelController(todo));\r\n    findControllerElement(fragment, \"todoActionsPanelController\")\r\n        .appendChild(todoActionsPanelController(todo));\r\n    findControllerElement(fragment, \"todoRenamePanelController\")\r\n        .appendChild(todoRenamePanelController(todo));\r\n    return fragment;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { todoController } from \"./todo-controller\";\r\n\r\nexport function todoListGroupController(todos: (Todo | CompletedTodo)[]): DocumentFragment {\r\n    let fragment = new DocumentFragment();\r\n    for (const todo of todos) {\r\n        fragment.appendChild(todoController(todo))\r\n    }\r\n    return fragment;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-list-group-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, findElement, setPropElements } from \"../utils\";\r\nimport { invalidNameInputHandler } from \"../app.common\";\r\n\r\nexport function todoRenamePanelController(todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = templateClone(\"todoRenamePanelTemplate\");\r\n    let input = findElement(fragment, \"input[name='name']\");\r\n    let inputId = input.getAttribute(\"id\");\r\n    let newInputId = `${inputId}-${todo.id}`;\r\n    let label = findElement(fragment, `label[for='${inputId}']`);\r\n    input.setAttribute(\"id\", newInputId);\r\n    input.setAttribute(\"value\", todo.name);\r\n    label.setAttribute(\"for\", newInputId);\r\n    setPropElements(fragment, \"todo-id\", todo.id);\r\n    $(input).on(\"invalid\", invalidNameInputHandler);\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-rename-panel-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, findControllerElement } from \"../utils\";\r\nimport { todoTitleController } from \"./todo-title-controller\";\r\n\r\nexport function todoTitlePanelController(todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = templateClone(\"todoTitlePanelTemplate\");\r\n    findControllerElement(fragment, \"todoTitleController\")\r\n        .appendChild(todoTitleController(todo));\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-title-panel-controller.ts","import { DomainEvent, UncommittedDomainEvent, AggregateIdType, DomainEventType } from \"../event-store\";\r\n\r\nexport type DomainEventHandler = (e: UncommittedDomainEvent) => void\r\n\r\nexport abstract class AggregateRoot {\r\n    private _uncommittedEvents: UncommittedDomainEvent[];\r\n    get uncommittedEvents(): UncommittedDomainEvent[] {\r\n        return this._uncommittedEvents;\r\n    }\r\n    protected _id: AggregateIdType\r\n    get id(): AggregateIdType {\r\n        return this._id;\r\n    }\r\n    protected init(): void {\r\n        this._uncommittedEvents = new Array<UncommittedDomainEvent>();\r\n    };\r\n    constructor(events: DomainEvent[]) {\r\n        this.init();\r\n        events.forEach(e => {\r\n            ((this as any)[DomainEventType[e.type]] as DomainEventHandler)(e);\r\n        });\r\n    }\r\n    protected applyAndStage(e: UncommittedDomainEvent) {\r\n        ((this as any)[DomainEventType[e.type]] as DomainEventHandler)(e);\r\n        this._uncommittedEvents.push(e);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./domain/aggregate-root.ts","import { TodoIdType } from \"./todo\";\r\nimport { UncommittedDomainEvent, AggregateIdType, DomainEventType } from \"../event-store\";\r\n\r\nexport class TodoAdded implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoAdded;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType,\r\n        readonly todoName: string\r\n    ) { }\r\n}\r\n\r\nexport class TodoRemoved implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoRemoved;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType\r\n    ) { }\r\n}\r\n\r\nexport class TodoCompleted implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoCompleted;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType,\r\n        readonly todoCompletionTimestamp: number\r\n    ) { }\r\n}\r\n\r\nexport class TodoUncompleted implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoUncompleted;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType\r\n    ) { }\r\n}\r\n\r\nexport class TodoRenamed implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoRenamed;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType,\r\n        readonly todoName: string\r\n    ) { }\r\n}\r\n\r\nexport class TodoPositionChanged implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoPositionChanged;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType,\r\n        readonly todoOffset: number\r\n    ) { }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./domain/events.ts","export type TodoIdType = string;\r\n\r\nexport class Todo {\r\n    readonly isCompleted: boolean = false;\r\n    constructor(\r\n        readonly id: TodoIdType,\r\n        public name: string\r\n    ) { }\r\n}\r\n\r\nexport class CompletedTodo extends Todo {\r\n    readonly isCompleted: boolean = true;\r\n    constructor(\r\n        id: TodoIdType,\r\n        name: string,\r\n        readonly completionTimestamp: number\r\n    ) {\r\n        super(id, name);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./domain/todo.ts","'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      request.onupgradeneeded = function(event) {\n        if (upgradeCallback) {\n          upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n        }\n      };\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/idb/lib/idb.js\n// module id = 25\n// module chunks = 0","// Unique ID creation requires a high quality random # generator.  We feature\n// detect to determine the best RNG source, normalizing to a function that\n// returns 128-bits of randomness, since that's what's usually required\nvar rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\n// random #'s we need to init node and clockseq\nvar _seedBytes = rng();\n\n// Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\nvar _nodeId = [\n  _seedBytes[0] | 0x01,\n  _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n];\n\n// Per 4.2.2, randomize (14 bit) clockseq\nvar _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n// Previous uuid creation time\nvar _lastMSecs = 0, _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  var node = options.node || _nodeId;\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/uuid/v1.js\n// module id = 26\n// module chunks = 0","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options == 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/uuid/v4.js\n// module id = 27\n// module chunks = 0","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 28\n// module chunks = 0"],"sourceRoot":""}