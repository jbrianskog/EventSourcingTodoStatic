{"version":3,"sources":["webpack:///bundle.b80c165404aa08d62b55.js","webpack:///webpack/bootstrap 026811f9dd3db6d56268","webpack:///./utils.ts","webpack:///./app.common.ts","webpack:///./event-store.ts","webpack:///./~/uuid/index.js","webpack:///./domain/todo-list.ts","webpack:///./controllers/history-todo-controller.ts","webpack:///./read.ts","webpack:///./~/uuid/lib/bytesToUuid.js","webpack:///./~/uuid/lib/rng-browser.js","webpack:///./controllers/add-todo-form-controller.ts","webpack:///./controllers/body-controller.ts","webpack:///./controllers/completed-todo-list-controller.ts","webpack:///./controllers/event-list-controller.ts","webpack:///./controllers/event-list-group-controller.ts","webpack:///./controllers/event-text-controller.ts","webpack:///./controllers/history-todo-list-panel-controller.ts","webpack:///./controllers/history-todo-title-panel-controller.ts","webpack:///./controllers/incomplete-todo-list-controller.ts","webpack:///./controllers/todo-actions-panel-buttons-controller.ts","webpack:///./controllers/todo-actions-panel-controller.ts","webpack:///./controllers/todo-controller.ts","webpack:///./controllers/todo-list-controller.ts","webpack:///./controllers/todo-list-group-controller.ts","webpack:///./controllers/todo-list-panel-controller.ts","webpack:///./controllers/todo-rename-panel-controller.ts","webpack:///./controllers/todo-title-controller.ts","webpack:///./controllers/todo-title-panel-controller.ts","webpack:///./app.ts","webpack:///./domain/aggregate-root.ts","webpack:///./domain/events.ts","webpack:///./domain/todo.ts","webpack:///./~/idb/lib/idb.js","webpack:///./~/uuid/v1.js","webpack:///./~/uuid/v4.js","webpack:///(webpack)/buildin/global.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","templateClone","id","selector","template","document","querySelector","Error","importNode","content","fillControllerElements","parentNode","controllerName","newChild","findControllerElements","forEach","elem","innerHTML","appendChild","findAllElements","fillContentElements","propName","findContentElements","textContent","setAttrElements","attrName","findAttrElements","setAttribute","findElement","element","elements","querySelectorAll","length","getRequiredAttribute","attributeName","getAttribute","refreshLists","di","todoListId","event_store_1","domainEventsByAggregate","then","events","todoList","todo_list_1","TodoList","utils_1","incompleteTodoListController","todos","completedTodoListController","completedTodos","eventListController","refreshBody","bodyController","invalidNameInputHandler","e","clearValidation","$form","removeClass","$button","addClass","off","validationEventNamespace","$input","input","currentTarget","$","closest","next","children","uuid_1","v4","on","validity","valid","contains","relatedTarget","todoIdDataAttrName","eventIdDataAttrName","open","idb_1","default","dbName","db","oldVersion","createObjectStore","domainEventStoreName","autoIncrement","keyPath","eventIdPropName","createIndex","aggregateIdPropName","catch","reason","alert","allDomainEvents","version","store","transaction","objectStore","getAll","IDBKeyRange","upperBound","aggregateId","index","eventsPromise","filter","postDomainEvents","tx","x","add","complete","DomainEventType","v1","uuid","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","writable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","descriptor","key","protoProps","staticProps","_get","receiver","Function","desc","getOwnPropertyDescriptor","undefined","parent","getPrototypeOf","aggregate_root_1","todo_1","events_1","_aggregate_root_1$Agg","this","apply","arguments","_todos","_id","push","Todo","todoId","todoName","findIndex","splice","oldTodo","newTodo","CompletedTodo","todoCompletionTimestamp","todo","find","arraySwap","arr","y","a","_this2","incompleteTodoPositions","reduce","isCompleted","Array","from","to","todoOffset","_i","agId","applyAndStage","TodoAdded","TodoRemoved","completionTimestamp","TodoCompleted","TodoUncompleted","TodoRenamed","offset","TodoPositionChanged","sort","AggregateRoot","historyTodoController","fragment","historyTodoTitlePanelController","todoListEvents","lists","todoLists","type","indexOf","bytesToUuid","buf","bth","byteToHex","toString","substr","global","rng","crypto","msCrypto","getRandomValues","rnds8","Uint8Array","rnds","r","Math","random","addTodoFormController","addTodoForm","addTodoInput","app_common_1","submit","preventDefault","read_1","reset","uncommittedEvents","todoListPanelController","DocumentFragment","todoListController","historyDi","assign","todoController","history_todo_controller_1","eventListDelegatedEventTarget","refreshBodyEventNamespace","e2","originalEvent","which","eventId","historyEvents","slice","parseInt","historyTodoListPanelController","eventListGroupController","listItemFragment","eventTextController","event","todoTitleController","todoActionsPanelButtonsController","todoActionsPanelController","todoTitlePanelController","todoRenamePanelController","todoListGroupController","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","err","return","completeTodoBtnHandler","isComplete","todoActionsBtn","Date","now","uncomplete","$todoListDelegatedEventTarget","val","rename","changePosition","remove","$defaultPanel","$actionsPanel","$bothPanels","actionsBtnGroup","eventNamespace","toggle","closeEvent","$renamePanel","first","focus","prev","inputId","newInputId","label","titleFragment","completionDateFragment","date","toLocaleDateString","body_controller_1","incomplete_todo_list_controller_1","completed_todo_list_controller_1","todo_list_controller_1","todo_list_group_controller_1","todo_controller_1","todo_title_panel_controller_1","todo_title_controller_1","todo_actions_panel_controller_1","todo_actions_panel_buttons_controller_1","todo_rename_panel_controller_1","event_list_controller_1","event_list_group_controller_1","event_text_controller_1","add_todo_form_controller_1","todo_list_panel_controller_1","history_todo_list_panel_controller_1","history_todo_title_panel_controller_1","window","indexedDB","_this","init","_uncommittedEvents","_Todo","toArray","promisifyRequest","request","Promise","resolve","reject","onsuccess","result","onerror","error","promisifyRequestCall","obj","method","args","promisifyCursorRequestCall","Cursor","proxyProperties","ProxyClass","targetProp","properties","prop","set","proxyRequestMethods","proxyMethods","proxyCursorRequestMethods","Index","_index","cursor","_cursor","_request","ObjectStore","_store","Transaction","idbTransaction","_tx","oncomplete","onabort","UpgradeDB","_db","DB","IDBIndex","IDBCursor","methodName","IDBObjectStore","IDBTransaction","IDBDatabase","funcName","replace","callback","nativeObject","query","count","items","iterateCursor","continue","exp","upgradeCallback","onupgradeneeded","delete","options","b","clockseq","_clockseq","msecs","getTime","nsecs","_lastNSecs","dt","_lastMSecs","tl","tmh","node","_nodeId","_seedBytes","ii","g","eval"],"mappings":"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","file":"bundle.b80c165404aa08d62b55.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 28);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction templateClone(id) {\n    var selector = \"template#\" + id;\n    var template = document.querySelector(selector);\n    if (!template) {\n        throw new Error(\"Document missing required '\" + selector + \"' element\");\n    }\n    var fragment = document.importNode(template.content, true);\n    return fragment;\n}\nexports.templateClone = templateClone;\nfunction fillControllerElements(parentNode, controllerName, newChild) {\n    findControllerElements(parentNode, controllerName).forEach(function (elem) {\n        elem.innerHTML = \"\";\n        elem.appendChild(newChild);\n    });\n}\nexports.fillControllerElements = fillControllerElements;\nfunction findControllerElements(parentNode, controllerName) {\n    var selector = \"[data-estd-controller='\" + controllerName + \"']\";\n    return findAllElements(parentNode, selector);\n}\nfunction fillContentElements(parentNode, propName, content) {\n    findContentElements(parentNode, propName).forEach(function (elem) {\n        return elem.textContent = content;\n    });\n}\nexports.fillContentElements = fillContentElements;\nfunction findContentElements(parentNode, propName) {\n    var selector = \"[data-estd-content='\" + propName + \"']\";\n    return findAllElements(parentNode, selector);\n}\nfunction setAttrElements(parentNode, attrName, value) {\n    findAttrElements(parentNode, attrName).forEach(function (elem) {\n        return elem.setAttribute(attrName, value);\n    });\n}\nexports.setAttrElements = setAttrElements;\nfunction findAttrElements(parentNode, attrName) {\n    var selector = \"[data-estd-attr='\" + attrName + \"']\";\n    return findAllElements(parentNode, selector);\n}\nfunction findElement(parentNode, selector) {\n    var element = parentNode.querySelector(selector);\n    if (!element) {\n        throw new Error(\"'\" + parentNode + \"' missing required '\" + selector + \"' element\");\n    }\n    return element;\n}\nexports.findElement = findElement;\nfunction findAllElements(parentNode, selector) {\n    var elements = parentNode.querySelectorAll(selector);\n    if (!elements.length) {\n        throw new Error(\"'\" + parentNode + \"' missing required '\" + selector + \"' element\");\n    }\n    return elements;\n}\nfunction getRequiredAttribute(element, attributeName) {\n    var value = element.getAttribute(attributeName);\n    if (!value) {\n        throw new Error(\"'\" + element + \"' missing required '\" + attributeName + \"' attribute\");\n    }\n    return value;\n}\nexports.getRequiredAttribute = getRequiredAttribute;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar event_store_1 = __webpack_require__(2);\nvar todo_list_1 = __webpack_require__(4);\nvar utils_1 = __webpack_require__(0);\nvar uuid_1 = __webpack_require__(3);\nexports.todoIdDataAttrName = \"data-estd-todo-id\";\nexports.eventIdDataAttrName = \"data-estd-event-id\";\nfunction refreshLists(di, todoListId) {\n    return event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n        var todoList = new todo_list_1.TodoList(events);\n        utils_1.fillControllerElements(document, \"incompleteTodoListController\", di.incompleteTodoListController(di, todoList.todos));\n        utils_1.fillControllerElements(document, \"completedTodoListController\", di.completedTodoListController(di, todoList.completedTodos));\n        utils_1.fillControllerElements(document, \"eventListController\", di.eventListController(di, events));\n    });\n}\nexports.refreshLists = refreshLists;\nfunction refreshBody(di, todoListId) {\n    return event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n        utils_1.fillControllerElements(document, \"bodyController\", di.bodyController(di, events));\n    });\n}\nexports.refreshBody = refreshBody;\nfunction invalidNameInputHandler(e) {\n    var input = e.currentTarget;\n    var $input = $(input);\n    var $form = $input.closest(\"form\");\n    var $button = $input.next().children(\"button\");\n    $form.addClass(\"has-error\");\n    $button.removeClass(\"btn-success\").addClass(\"btn-danger\");\n    var validationEventNamespace = \".nameTodoInputValidation:\" + uuid_1.v4();\n    function clearValidation() {\n        $form.removeClass(\"has-error\");\n        $button.removeClass(\"btn-danger\").addClass(\"btn-success\");\n        $form.off(validationEventNamespace);\n        $input.off(validationEventNamespace);\n    }\n    $input.on(\"input\" + validationEventNamespace, function (e) {\n        if (input.validity.valid) {\n            clearValidation();\n        }\n    });\n    $form.on(\"focusout\" + validationEventNamespace, function (e) {\n        if (!e.currentTarget.contains(e.relatedTarget)) {\n            clearValidation();\n        }\n    });\n}\nexports.invalidNameInputHandler = invalidNameInputHandler;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar idb_1 = __webpack_require__(32);\nvar DomainEventType;\n(function (DomainEventType) {\n    DomainEventType[DomainEventType[\"TodoAdded\"] = 0] = \"TodoAdded\";\n    DomainEventType[DomainEventType[\"TodoRemoved\"] = 1] = \"TodoRemoved\";\n    DomainEventType[DomainEventType[\"TodoCompleted\"] = 2] = \"TodoCompleted\";\n    DomainEventType[DomainEventType[\"TodoUncompleted\"] = 3] = \"TodoUncompleted\";\n    DomainEventType[DomainEventType[\"TodoRenamed\"] = 4] = \"TodoRenamed\";\n    DomainEventType[DomainEventType[\"TodoPositionChanged\"] = 5] = \"TodoPositionChanged\";\n})(DomainEventType = exports.DomainEventType || (exports.DomainEventType = {}));\nvar dbName = \"estd-db\";\nvar domainEventStoreName = \"domain-event\";\nvar aggregateIdPropName = \"aggregateId\";\nvar eventIdPropName = \"id\";\nfunction open() {\n    return idb_1.default.open(dbName, 1, function (db) {\n        switch (db.oldVersion) {\n            case 0:\n                db.createObjectStore(domainEventStoreName, { autoIncrement: true, keyPath: eventIdPropName }).createIndex(aggregateIdPropName, aggregateIdPropName);\n        }\n    }).catch(function (reason) {\n        alert(\"Database error: \" + reason);\n    });\n}\nfunction allDomainEvents(version) {\n    return open().then(function (db) {\n        var store = db.transaction(domainEventStoreName).objectStore(domainEventStoreName);\n        return version ? store.getAll(IDBKeyRange.upperBound(version)) : store.getAll();\n    }).catch(function (reason) {\n        alert(\"Database error: \" + reason);\n    });\n}\nexports.allDomainEvents = allDomainEvents;\nfunction domainEventsByAggregate(aggregateId, version) {\n    return open().then(function (db) {\n        var index = db.transaction(domainEventStoreName).objectStore(domainEventStoreName).index(aggregateIdPropName);\n        var eventsPromise = index.getAll(aggregateId);\n        return version ? eventsPromise.then(function (events) {\n            return events.filter(function (e) {\n                return e.id <= version;\n            });\n        }) : eventsPromise;\n    }).catch(function (reason) {\n        alert(\"Database error: \" + reason);\n    });\n}\nexports.domainEventsByAggregate = domainEventsByAggregate;\nfunction postDomainEvents(events) {\n    return open().then(function (db) {\n        var tx = db.transaction(domainEventStoreName, \"readwrite\");\n        var store = tx.objectStore(domainEventStoreName);\n        events.forEach(function (x) {\n            return store.add(x);\n        });\n        return tx.complete;\n    }).catch(function (reason) {\n        alert(\"Database error: \" + reason);\n    });\n}\nexports.postDomainEvents = postDomainEvents;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar v1 = __webpack_require__(33);\nvar v4 = __webpack_require__(34);\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar aggregate_root_1 = __webpack_require__(29);\nvar todo_1 = __webpack_require__(31);\nvar events_1 = __webpack_require__(30);\nvar uuid_1 = __webpack_require__(3);\n\nvar TodoList = function (_aggregate_root_1$Agg) {\n    _inherits(TodoList, _aggregate_root_1$Agg);\n\n    function TodoList() {\n        _classCallCheck(this, TodoList);\n\n        return _possibleConstructorReturn(this, (TodoList.__proto__ || Object.getPrototypeOf(TodoList)).apply(this, arguments));\n    }\n\n    _createClass(TodoList, [{\n        key: \"init\",\n        value: function init() {\n            _get(TodoList.prototype.__proto__ || Object.getPrototypeOf(TodoList.prototype), \"init\", this).call(this);\n            this._todos = [];\n        }\n        // Domain Event Handlers\n\n    }, {\n        key: \"TodoAdded\",\n        value: function TodoAdded(e) {\n            if (!this.id) {\n                this._id = e.aggregateId;\n            }\n            this._todos.push(new todo_1.Todo(e.todoId, e.todoName));\n        }\n    }, {\n        key: \"TodoRemoved\",\n        value: function TodoRemoved(e) {\n            var i = this._todos.findIndex(function (x) {\n                return x.id === e.todoId;\n            });\n            if (i !== -1) {\n                this._todos.splice(i, 1);\n            }\n        }\n    }, {\n        key: \"TodoCompleted\",\n        value: function TodoCompleted(e) {\n            var i = this._todos.findIndex(function (x) {\n                return x.id === e.todoId;\n            });\n            if (i !== -1) {\n                var oldTodo = this._todos[i];\n                var newTodo = new todo_1.CompletedTodo(oldTodo.id, oldTodo.name, e.todoCompletionTimestamp);\n                this._todos[i] = newTodo;\n            }\n        }\n    }, {\n        key: \"TodoUncompleted\",\n        value: function TodoUncompleted(e) {\n            var i = this._todos.findIndex(function (x) {\n                return x.id === e.todoId;\n            });\n            if (i !== -1) {\n                var oldTodo = this._todos[i];\n                var newTodo = new todo_1.Todo(oldTodo.id, oldTodo.name);\n                this._todos[i] = newTodo;\n            }\n        }\n    }, {\n        key: \"TodoRenamed\",\n        value: function TodoRenamed(e) {\n            var todo = this._todos.find(function (x) {\n                return x.id === e.todoId;\n            });\n            if (todo) {\n                todo.name = e.todoName;\n            }\n        }\n    }, {\n        key: \"TodoPositionChanged\",\n        value: function TodoPositionChanged(e) {\n            var _this2 = this;\n\n            var incompleteTodoPositions = this._todos.reduce(function (p, c, i) {\n                if (!c.isCompleted) {\n                    p.push(i);\n                }\n                return p;\n            }, new Array());\n            var from = incompleteTodoPositions.findIndex(function (x) {\n                return _this2._todos[x].id === e.todoId;\n            });\n            if (from === -1) {\n                return;\n            }\n            var to = from + e.todoOffset;\n            if (to < 0) {\n                to = 0;\n            } else if (to > incompleteTodoPositions.length - 1) {\n                to = incompleteTodoPositions.length - 1;\n            }\n            if (from === to) {\n                return;\n            }\n            if (to < from) {\n                for (var i = to; i < from; i++) {\n                    arraySwap(this._todos, incompleteTodoPositions[from], incompleteTodoPositions[i]);\n                }\n            } else {\n                for (var _i = to; _i > from; _i--) {\n                    arraySwap(this._todos, incompleteTodoPositions[from], incompleteTodoPositions[_i]);\n                }\n            }\n            function arraySwap(arr, x, y) {\n                var a = arr[x];\n                arr[x] = arr[y];\n                arr[y] = a;\n            }\n        }\n    }, {\n        key: \"add\",\n        value: function add(id, name) {\n            var agId = this.id || uuid_1.v4();\n            this.applyAndStage(new events_1.TodoAdded(agId, id, name));\n        }\n    }, {\n        key: \"remove\",\n        value: function remove(id) {\n            this.applyAndStage(new events_1.TodoRemoved(this.id, id));\n        }\n    }, {\n        key: \"complete\",\n        value: function complete(id, completionTimestamp) {\n            this.applyAndStage(new events_1.TodoCompleted(this.id, id, completionTimestamp));\n        }\n    }, {\n        key: \"uncomplete\",\n        value: function uncomplete(id) {\n            this.applyAndStage(new events_1.TodoUncompleted(this.id, id));\n        }\n    }, {\n        key: \"rename\",\n        value: function rename(id, name) {\n            this.applyAndStage(new events_1.TodoRenamed(this.id, id, name));\n        }\n    }, {\n        key: \"changePosition\",\n        value: function changePosition(id, offset) {\n            this.applyAndStage(new events_1.TodoPositionChanged(this.id, id, offset));\n        }\n    }, {\n        key: \"todos\",\n        get: function get() {\n            return this._todos.filter(function (x) {\n                return !x.isCompleted;\n            });\n        }\n    }, {\n        key: \"completedTodos\",\n        get: function get() {\n            return this._todos.filter(function (x) {\n                return x.isCompleted;\n            }).sort(function (x, y) {\n                return y.completionTimestamp - x.completionTimestamp;\n            });\n        }\n    }]);\n\n    return TodoList;\n}(aggregate_root_1.AggregateRoot);\n\nexports.TodoList = TodoList;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction historyTodoController(di, todo) {\n    var fragment = todo.isCompleted ? utils_1.templateClone(\"historyCompletedTodoTemplate\") : utils_1.templateClone(\"historyTodoTemplate\");\n    utils_1.fillControllerElements(fragment, \"historyTodoTitlePanelController\", di.historyTodoTitlePanelController(di, todo));\n    return fragment;\n}\nexports.historyTodoController = historyTodoController;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar event_store_1 = __webpack_require__(2);\nfunction todoListEvents() {\n    // This app's domain and event-store are designed to accommodate multiple aggregates of different types.\n    // Currently, the app only has one aggregate type (TodoList) and only allows the user to have one instance of that aggregate.\n    // This todoLists() lookup occurs to get the aggreateId of the user's one TodoList.\n    return event_store_1.allDomainEvents().then(function (events) {\n        var lists = todoLists(events);\n        return lists.length ? event_store_1.domainEventsByAggregate(lists[0]) : [];\n    });\n}\nexports.todoListEvents = todoListEvents;\nfunction todoLists(events) {\n    return events.reduce(function (p, c) {\n        if (c.type === event_store_1.DomainEventType.TodoAdded && p.indexOf(c.aggregateId) === -1) {\n            p.push(c.aggregateId);\n        }\n        return p;\n    }, []);\n}\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports) {\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  return  bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\nmodule.exports = bytesToUuid;\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global) {// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\nvar rng;\n\nvar crypto = global.crypto || global.msCrypto; // for IE 11\nif (crypto && crypto.getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16);\n  rng = function whatwgRNG() {\n    crypto.getRandomValues(rnds8);\n    return rnds8;\n  };\n}\n\nif (!rng) {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var  rnds = new Array(16);\n  rng = function() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n\nmodule.exports = rng;\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(35)))\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar app_common_1 = __webpack_require__(1);\nvar event_store_1 = __webpack_require__(2);\nvar read_1 = __webpack_require__(6);\nvar uuid_1 = __webpack_require__(3);\nvar todo_list_1 = __webpack_require__(4);\nfunction addTodoFormController(di, todoListId) {\n    var fragment = utils_1.templateClone(\"addTodoFormTemplate\");\n    var addTodoForm = utils_1.findElement(fragment, \"#addTodoForm\");\n    var addTodoInput = utils_1.findElement(addTodoForm, \"#addTodoInput\");\n    $(addTodoInput).on(\"invalid\", app_common_1.invalidNameInputHandler);\n    $(addTodoForm).submit(function (e) {\n        e.preventDefault();\n        // This is to deal with the possibility that the user opens the app for the first time in two tabs\n        // and adds a to-do to each new TodoList. TodoList ids are generated when the first Todo is\n        // added to them. So, on first load, there are no Todos and no TodoLists, and this handler\n        // can't know whether to create a new TodoList or load one that might have been made in another tab.\n        // So, if the current TodoList has no id -- i.e. no todos have been added -- we check if any other\n        // tab has added a new TodoList and use that id.\n        var eventsPromise = todoListId ? event_store_1.domainEventsByAggregate(todoListId) : read_1.todoListEvents();\n        eventsPromise.then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            todoList.add(uuid_1.v4(), addTodoInput.value);\n            addTodoForm.reset();\n            // This assignment is only necessary when the first Todo is added to a new TodoList.\n            todoListId = todoList.id;\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return di.refreshLists(di, todoListId);\n        });\n    });\n    return fragment;\n}\nexports.addTodoFormController = addTodoFormController;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction bodyController(di, events) {\n    var fragment = utils_1.templateClone(\"bodyTemplate\");\n    utils_1.fillControllerElements(fragment, \"todoListPanelController\", di.todoListPanelController(di, events));\n    utils_1.fillControllerElements(fragment, \"eventListController\", di.eventListController(di, events));\n    return fragment;\n}\nexports.bodyController = bodyController;\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction completedTodoListController(di, todos) {\n    if (!todos.length) {\n        return new DocumentFragment();\n    }\n    var fragment = utils_1.templateClone(\"completedTodoListTemplate\");\n    utils_1.fillControllerElements(fragment, \"todoListController\", di.todoListController(di, todos));\n    return fragment;\n}\nexports.completedTodoListController = completedTodoListController;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar app_common_1 = __webpack_require__(1);\nvar history_todo_controller_1 = __webpack_require__(5);\nvar uuid_1 = __webpack_require__(3);\nfunction eventListController(di, events) {\n    if (!events.length) {\n        return utils_1.templateClone(\"emptyEventListTemplate\");\n    }\n    var todoListId = events[0].aggregateId;\n    var fragment = utils_1.templateClone(\"eventListTemplate\");\n    var historyDi = Object.assign({}, di);\n    historyDi.todoController = history_todo_controller_1.historyTodoController;\n    var eventListDelegatedEventTarget = utils_1.findElement(fragment, \"#eventListDelegatedEventTarget\");\n    var $eventListDelegatedEventTarget = $(eventListDelegatedEventTarget);\n    $eventListDelegatedEventTarget.on(\"click\", \".event-list-item\", function (e) {\n        var refreshBodyEventNamespace = \".activeEventFocusOut:\" + uuid_1.v4();\n        // This handler will reset the body to the interactive todolist when the user clicks\n        // anywhere in the document outside of the event list.\n        $(document).on(\"click\" + refreshBodyEventNamespace + \" keypress\" + refreshBodyEventNamespace, function (e2) {\n            // Short-circuit when handler is triggered by event that created it\n            // or when isn't an 'enter' keypress\n            // or when the event-list-item contains the click target\n            if (e.originalEvent === e2.originalEvent || e2.type === \"keypress\" && e2.which !== 13 || e.currentTarget.contains(e2.target)) {\n                return;\n            }\n            $(document).off(refreshBodyEventNamespace);\n            if (!eventListDelegatedEventTarget.contains(e2.target)) {\n                di.refreshBody(di, todoListId);\n            }\n        });\n        var eventId = utils_1.getRequiredAttribute(e.currentTarget, app_common_1.eventIdDataAttrName);\n        var historyEvents = events.slice(0, parseInt(eventId));\n        utils_1.fillControllerElements(document, \"todoListPanelController\", historyDi.historyTodoListPanelController(historyDi, historyEvents));\n    });\n    utils_1.fillControllerElements(fragment, \"eventListGroupController\", di.eventListGroupController(di, events));\n    return fragment;\n}\nexports.eventListController = eventListController;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar app_common_1 = __webpack_require__(1);\nfunction eventListGroupController(di, events) {\n    if (events.length) {\n        var fragment = new DocumentFragment();\n        events.forEach(function (e) {\n            var listItemFragment = utils_1.templateClone(\"eventListItemTemplate\");\n            utils_1.setAttrElements(listItemFragment, app_common_1.eventIdDataAttrName, e.id.toString());\n            utils_1.fillControllerElements(listItemFragment, \"eventTextController\", di.eventTextController(di, e));\n            fragment.appendChild(listItemFragment);\n        });\n        return fragment;\n    } else {\n        var _fragment = utils_1.templateClone(\"emptyEventListTemplate\");\n        return _fragment;\n    }\n}\nexports.eventListGroupController = eventListGroupController;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar event_store_1 = __webpack_require__(2);\nfunction eventTextController(di, event) {\n    var fragment = new DocumentFragment();\n    fragment.textContent = event.id + \" : \" + event_store_1.DomainEventType[event.type];\n    return fragment;\n}\nexports.eventTextController = eventTextController;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar todo_list_1 = __webpack_require__(4);\nfunction historyTodoListPanelController(di, events) {\n    var fragment = utils_1.templateClone(\"historyTodoListPanelTemplate\");\n    var todoList = new todo_list_1.TodoList(events);\n    utils_1.fillControllerElements(fragment, \"incompleteTodoListController\", di.incompleteTodoListController(di, todoList.todos));\n    utils_1.fillControllerElements(fragment, \"completedTodoListController\", di.completedTodoListController(di, todoList.completedTodos));\n    return fragment;\n}\nexports.historyTodoListPanelController = historyTodoListPanelController;\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction historyTodoTitlePanelController(di, todo) {\n    var fragment = utils_1.templateClone(\"historyTodoTitlePanelTemplate\");\n    utils_1.fillControllerElements(fragment, \"todoTitleController\", di.todoTitleController(di, todo));\n    return fragment;\n}\nexports.historyTodoTitlePanelController = historyTodoTitlePanelController;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction incompleteTodoListController(di, todos) {\n    if (!todos.length) {\n        return new DocumentFragment();\n    }\n    var fragment = utils_1.templateClone(\"incompleteTodoListTemplate\");\n    utils_1.fillControllerElements(fragment, \"todoListController\", di.todoListController(di, todos));\n    return fragment;\n}\nexports.incompleteTodoListController = incompleteTodoListController;\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar app_common_1 = __webpack_require__(1);\nfunction todoActionsPanelButtonsController(di, todo) {\n    var fragment = utils_1.templateClone(\"todoDeleteBtnTemplate\");\n    if (!todo.isCompleted) {\n        fragment.appendChild(utils_1.templateClone(\"todoMoveUpBtnTemplate\"));\n        fragment.appendChild(utils_1.templateClone(\"todoMoveDownBtnTemplate\"));\n    }\n    fragment.appendChild(utils_1.templateClone(\"todoRenameBtnTemplate\"));\n    utils_1.setAttrElements(fragment, app_common_1.todoIdDataAttrName, todo.id);\n    return fragment;\n}\nexports.todoActionsPanelButtonsController = todoActionsPanelButtonsController;\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction todoActionsPanelController(di, todo) {\n    var fragment = utils_1.templateClone(\"todoActionsPanelTemplate\");\n    utils_1.fillControllerElements(fragment, \"todoTitleController\", di.todoTitleController(di, todo));\n    utils_1.fillControllerElements(fragment, \"todoActionsPanelButtonsController\", di.todoActionsPanelButtonsController(di, todo));\n    return fragment;\n}\nexports.todoActionsPanelController = todoActionsPanelController;\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar app_common_1 = __webpack_require__(1);\nfunction todoController(di, todo) {\n    var fragment = todo.isCompleted ? utils_1.templateClone(\"completedTodoTemplate\") : utils_1.templateClone(\"todoTemplate\");\n    utils_1.setAttrElements(fragment, app_common_1.todoIdDataAttrName, todo.id);\n    utils_1.fillControllerElements(fragment, \"todoTitlePanelController\", di.todoTitlePanelController(di, todo));\n    utils_1.fillControllerElements(fragment, \"todoActionsPanelController\", di.todoActionsPanelController(di, todo));\n    utils_1.fillControllerElements(fragment, \"todoRenamePanelController\", di.todoRenamePanelController(di, todo));\n    return fragment;\n}\nexports.todoController = todoController;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction todoListController(di, todos) {\n    var fragment = utils_1.templateClone(\"todoListTemplate\");\n    utils_1.fillControllerElements(fragment, \"todoListGroupController\", di.todoListGroupController(di, todos));\n    return fragment;\n}\nexports.todoListController = todoListController;\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction todoListGroupController(di, todos) {\n    var fragment = new DocumentFragment();\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n        for (var _iterator = todos[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var todo = _step.value;\n\n            fragment.appendChild(di.todoController(di, todo));\n        }\n    } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n    } finally {\n        try {\n            if (!_iteratorNormalCompletion && _iterator.return) {\n                _iterator.return();\n            }\n        } finally {\n            if (_didIteratorError) {\n                throw _iteratorError;\n            }\n        }\n    }\n\n    return fragment;\n}\nexports.todoListGroupController = todoListGroupController;\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar event_store_1 = __webpack_require__(2);\nvar utils_1 = __webpack_require__(0);\nvar todo_list_1 = __webpack_require__(4);\nvar app_common_1 = __webpack_require__(1);\nvar uuid_1 = __webpack_require__(3);\nfunction todoListPanelController(di, events) {\n    var fragment = utils_1.templateClone(\"todoListPanelTemplate\");\n    var todoList = new todo_list_1.TodoList(events);\n    var todoListId = todoList.id;\n    var $todoListDelegatedEventTarget = $(utils_1.findElement(fragment, \"#todolistDelegatedEventTarget\"));\n    $todoListDelegatedEventTarget.on(\"submit\", \".renameTodoForm\", function (e) {\n        e.preventDefault();\n        event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            var todoName = $(e.currentTarget).find(\"input[name='name']\").val();\n            var todoId = utils_1.getRequiredAttribute(e.currentTarget, app_common_1.todoIdDataAttrName);\n            todoList.rename(todoId, todoName);\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return di.refreshLists(di, todoListId);\n        });\n    });\n    // Need to handle keypress here because the completeTodoBtn is an <a> without an href,\n    // so tabbing to it and pressing enter doesn't trigger a click event like it would with a <button>.\n    // I want completeTodoBtn to act like a <button>, but it has another <button> inside of it (todoActionsBtn),\n    // so browsers and Bootstrap styling wouldn't work if it was a <button> (HTML spec says no interactive content\n    // inside interactive content). By using an <a> with no href I get the a.list-group-item Bootstrap styling.\n    $todoListDelegatedEventTarget.on(\"click keypress\", \".completeTodoBtn\", function (e) {\n        completeTodoBtnHandler(e, true);\n    });\n    $todoListDelegatedEventTarget.on(\"click keypress\", \".uncompleteTodoBtn\", function (e) {\n        completeTodoBtnHandler(e, false);\n    });\n    function completeTodoBtnHandler(e, isComplete) {\n        // only handle \"enter\" keypresses\n        if (e.type === \"keypress\" && e.which !== 13) {\n            return;\n        }\n        // short-circuit if this event has bubbled up from the todoActionsBtn (which is inside (un)complete todo buttons)\n        var todoActionsBtn = $(e.currentTarget).find(\".todoActionsBtn\")[0];\n        if (todoActionsBtn === e.target || $.contains(todoActionsBtn, e.target)) {\n            return;\n        }\n        event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            var todoId = utils_1.getRequiredAttribute(e.currentTarget, app_common_1.todoIdDataAttrName);\n            if (isComplete) {\n                todoList.complete(todoId, Date.now());\n            } else {\n                todoList.uncomplete(todoId);\n            }\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return di.refreshLists(di, todoListId);\n        });\n    }\n    $todoListDelegatedEventTarget.on(\"click\", \".moveTodoUpBtn\", function (e) {\n        event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            var todoId = utils_1.getRequiredAttribute(e.currentTarget, app_common_1.todoIdDataAttrName);\n            todoList.changePosition(todoId, -1);\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return di.refreshLists(di, todoListId);\n        });\n    });\n    $todoListDelegatedEventTarget.on(\"click\", \".moveTodoDownBtn\", function (e) {\n        event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            var todoId = utils_1.getRequiredAttribute(e.currentTarget, app_common_1.todoIdDataAttrName);\n            todoList.changePosition(todoId, 1);\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return di.refreshLists(di, todoListId);\n        });\n    });\n    $todoListDelegatedEventTarget.on(\"click\", \".deleteTodoBtn\", function (e) {\n        event_store_1.domainEventsByAggregate(todoListId).then(function (events) {\n            var todoList = new todo_list_1.TodoList(events);\n            var todoId = utils_1.getRequiredAttribute(e.currentTarget, app_common_1.todoIdDataAttrName);\n            todoList.remove(todoId);\n            return event_store_1.postDomainEvents(todoList.uncommittedEvents);\n        }).then(function () {\n            return di.refreshLists(di, todoListId);\n        });\n    });\n    $todoListDelegatedEventTarget.on(\"click\", \".todoActionsBtn\", function (e) {\n        var $defaultPanel = $(e.currentTarget).closest(\".todoPanelDefault\"),\n            $actionsPanel = $defaultPanel.next(),\n            $bothPanels = $defaultPanel.add($actionsPanel),\n            actionsBtnGroup = $actionsPanel.find(\".todoActionsPanelBtnGroup\")[0],\n            eventNamespace = \"click.todoActionsPanelClose:\" + uuid_1.v4();\n        $bothPanels.toggle();\n        // This handler will close (i.e. toggle) the ActionsPanel when the user clicks anywhere in the document outside of the actionsBtnGroup.\n        // eventNamespace is unique (probably) so each instance of this handler can only detach itself.\n        $(document).on(eventNamespace, function (closeEvent) {\n            // Short-circuit when handler is triggered by event that created it.\n            // This happens because this handler is created in the todolistDelegatedEventTarget handler but attached to the document.\n            // So, when the todolistDelegatedEventTarget handler returns, the click event that triggered it will still bubble to the document.\n            if (e.originalEvent === closeEvent.originalEvent) {\n                return;\n            }\n            if (!$.contains(actionsBtnGroup, closeEvent.target)) {\n                $bothPanels.toggle();\n            }\n            $(document).off(eventNamespace);\n        });\n    });\n    $todoListDelegatedEventTarget.on(\"click\", \".renameTodoBtn\", function (e) {\n        var $actionsPanel = $(e.currentTarget).closest(\".todoActionsPanel\");\n        var $renamePanel = $actionsPanel.next();\n        $actionsPanel.add($renamePanel).toggle();\n        $renamePanel.find(\".renameTodoBtnClickFocusTarget\").first().focus();\n    });\n    $todoListDelegatedEventTarget.on(\"blur\", \".renameTodoForm\", function (e) {\n        if (!(e.relatedTarget && $.contains(e.currentTarget, e.relatedTarget))) {\n            var $renamePanel = $(e.currentTarget).closest(\".todoRenamePanel\");\n            $renamePanel.prev().prev().add($renamePanel).toggle();\n        }\n    });\n    utils_1.fillControllerElements(fragment, \"addTodoFormController\", di.addTodoFormController(di, todoListId));\n    utils_1.fillControllerElements(fragment, \"incompleteTodoListController\", di.incompleteTodoListController(di, todoList.todos));\n    utils_1.fillControllerElements(fragment, \"completedTodoListController\", di.completedTodoListController(di, todoList.completedTodos));\n    return fragment;\n}\nexports.todoListPanelController = todoListPanelController;\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nvar app_common_1 = __webpack_require__(1);\nfunction todoRenamePanelController(di, todo) {\n    var fragment = utils_1.templateClone(\"todoRenamePanelTemplate\");\n    var input = utils_1.findElement(fragment, \"input[name='name']\");\n    var inputId = input.getAttribute(\"id\");\n    var newInputId = inputId + \"-\" + todo.id;\n    var label = utils_1.findElement(fragment, \"label[for='\" + inputId + \"']\");\n    input.setAttribute(\"id\", newInputId);\n    input.setAttribute(\"value\", todo.name);\n    label.setAttribute(\"for\", newInputId);\n    utils_1.setAttrElements(fragment, app_common_1.todoIdDataAttrName, todo.id);\n    $(input).on(\"invalid\", app_common_1.invalidNameInputHandler);\n    return fragment;\n}\nexports.todoRenamePanelController = todoRenamePanelController;\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction todoTitleController(di, todo) {\n    var titleFragment = new DocumentFragment();\n    titleFragment.textContent = todo.name;\n    if (todo.isCompleted) {\n        var completionDateFragment = utils_1.templateClone(\"todoCompletionDateTemplate\");\n        var date = new Date(todo.completionTimestamp);\n        utils_1.fillContentElements(completionDateFragment, \"completionDate\", date.toLocaleDateString());\n        titleFragment.appendChild(completionDateFragment);\n    }\n    return titleFragment;\n}\nexports.todoTitleController = todoTitleController;\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = __webpack_require__(0);\nfunction todoTitlePanelController(di, todo) {\n    var fragment = utils_1.templateClone(\"todoTitlePanelTemplate\");\n    utils_1.fillControllerElements(fragment, \"todoTitleController\", di.todoTitleController(di, todo));\n    return fragment;\n}\nexports.todoTitlePanelController = todoTitlePanelController;\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__webpack_require__(27);\nvar utils_1 = __webpack_require__(0);\nvar read_1 = __webpack_require__(6);\nvar body_controller_1 = __webpack_require__(10);\nvar incomplete_todo_list_controller_1 = __webpack_require__(17);\nvar completed_todo_list_controller_1 = __webpack_require__(11);\nvar todo_list_controller_1 = __webpack_require__(21);\nvar todo_list_group_controller_1 = __webpack_require__(22);\nvar todo_controller_1 = __webpack_require__(20);\nvar todo_title_panel_controller_1 = __webpack_require__(26);\nvar todo_title_controller_1 = __webpack_require__(25);\nvar todo_actions_panel_controller_1 = __webpack_require__(19);\nvar todo_actions_panel_buttons_controller_1 = __webpack_require__(18);\nvar todo_rename_panel_controller_1 = __webpack_require__(24);\nvar event_list_controller_1 = __webpack_require__(12);\nvar event_list_group_controller_1 = __webpack_require__(13);\nvar event_text_controller_1 = __webpack_require__(14);\nvar add_todo_form_controller_1 = __webpack_require__(9);\nvar todo_list_panel_controller_1 = __webpack_require__(23);\nvar history_todo_list_panel_controller_1 = __webpack_require__(15);\nvar history_todo_controller_1 = __webpack_require__(5);\nvar history_todo_title_panel_controller_1 = __webpack_require__(16);\nvar app_common_1 = __webpack_require__(1);\nif (!window.indexedDB) {\n    window.alert(\"Your browser doesn't support IndexedDB (the browser feature this app uses to store your To-dos). Update your browser to its latest version.\");\n}\nvar di = {\n    bodyController: body_controller_1.bodyController,\n    todoListPanelController: todo_list_panel_controller_1.todoListPanelController,\n    addTodoFormController: add_todo_form_controller_1.addTodoFormController,\n    incompleteTodoListController: incomplete_todo_list_controller_1.incompleteTodoListController,\n    completedTodoListController: completed_todo_list_controller_1.completedTodoListController,\n    todoListController: todo_list_controller_1.todoListController,\n    todoListGroupController: todo_list_group_controller_1.todoListGroupController,\n    todoController: todo_controller_1.todoController,\n    todoTitlePanelController: todo_title_panel_controller_1.todoTitlePanelController,\n    todoTitleController: todo_title_controller_1.todoTitleController,\n    todoActionsPanelController: todo_actions_panel_controller_1.todoActionsPanelController,\n    todoActionsPanelButtonsController: todo_actions_panel_buttons_controller_1.todoActionsPanelButtonsController,\n    todoRenamePanelController: todo_rename_panel_controller_1.todoRenamePanelController,\n    eventListController: event_list_controller_1.eventListController,\n    eventListGroupController: event_list_group_controller_1.eventListGroupController,\n    eventTextController: event_text_controller_1.eventTextController,\n    refreshLists: app_common_1.refreshLists,\n    refreshBody: app_common_1.refreshBody,\n    historyTodoListPanelController: history_todo_list_panel_controller_1.historyTodoListPanelController,\n    historyTodoController: history_todo_controller_1.historyTodoController,\n    historyTodoTitlePanelController: history_todo_title_panel_controller_1.historyTodoTitlePanelController\n};\nread_1.todoListEvents().then(function (events) {\n    utils_1.fillControllerElements(document, \"bodyController\", di.bodyController(di, events));\n});\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar event_store_1 = __webpack_require__(2);\n\nvar AggregateRoot = function () {\n    _createClass(AggregateRoot, [{\n        key: \"init\",\n        value: function init() {\n            this._uncommittedEvents = new Array();\n        }\n    }, {\n        key: \"uncommittedEvents\",\n        get: function get() {\n            return this._uncommittedEvents;\n        }\n    }, {\n        key: \"id\",\n        get: function get() {\n            return this._id;\n        }\n    }]);\n\n    function AggregateRoot(events) {\n        var _this = this;\n\n        _classCallCheck(this, AggregateRoot);\n\n        this.init();\n        events.forEach(function (e) {\n            _this[event_store_1.DomainEventType[e.type]](e);\n        });\n    }\n\n    _createClass(AggregateRoot, [{\n        key: \"applyAndStage\",\n        value: function applyAndStage(e) {\n            this[event_store_1.DomainEventType[e.type]](e);\n            this._uncommittedEvents.push(e);\n        }\n    }]);\n\n    return AggregateRoot;\n}();\n\nexports.AggregateRoot = AggregateRoot;\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar event_store_1 = __webpack_require__(2);\n\nvar TodoAdded = function TodoAdded(aggregateId, todoId, todoName) {\n    _classCallCheck(this, TodoAdded);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.todoName = todoName;\n    this.type = event_store_1.DomainEventType.TodoAdded;\n};\n\nexports.TodoAdded = TodoAdded;\n\nvar TodoRemoved = function TodoRemoved(aggregateId, todoId) {\n    _classCallCheck(this, TodoRemoved);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.type = event_store_1.DomainEventType.TodoRemoved;\n};\n\nexports.TodoRemoved = TodoRemoved;\n\nvar TodoCompleted = function TodoCompleted(aggregateId, todoId, todoCompletionTimestamp) {\n    _classCallCheck(this, TodoCompleted);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.todoCompletionTimestamp = todoCompletionTimestamp;\n    this.type = event_store_1.DomainEventType.TodoCompleted;\n};\n\nexports.TodoCompleted = TodoCompleted;\n\nvar TodoUncompleted = function TodoUncompleted(aggregateId, todoId) {\n    _classCallCheck(this, TodoUncompleted);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.type = event_store_1.DomainEventType.TodoUncompleted;\n};\n\nexports.TodoUncompleted = TodoUncompleted;\n\nvar TodoRenamed = function TodoRenamed(aggregateId, todoId, todoName) {\n    _classCallCheck(this, TodoRenamed);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.todoName = todoName;\n    this.type = event_store_1.DomainEventType.TodoRenamed;\n};\n\nexports.TodoRenamed = TodoRenamed;\n\nvar TodoPositionChanged = function TodoPositionChanged(aggregateId, todoId, todoOffset) {\n    _classCallCheck(this, TodoPositionChanged);\n\n    this.aggregateId = aggregateId;\n    this.todoId = todoId;\n    this.todoOffset = todoOffset;\n    this.type = event_store_1.DomainEventType.TodoPositionChanged;\n};\n\nexports.TodoPositionChanged = TodoPositionChanged;\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\nvar Todo = function Todo(id, name) {\n    _classCallCheck(this, Todo);\n\n    this.id = id;\n    this.name = name;\n    this.isCompleted = false;\n};\n\nexports.Todo = Todo;\n\nvar CompletedTodo = function (_Todo) {\n    _inherits(CompletedTodo, _Todo);\n\n    function CompletedTodo(id, name, completionTimestamp) {\n        _classCallCheck(this, CompletedTodo);\n\n        var _this = _possibleConstructorReturn(this, (CompletedTodo.__proto__ || Object.getPrototypeOf(CompletedTodo)).call(this, id, name));\n\n        _this.completionTimestamp = completionTimestamp;\n        _this.isCompleted = true;\n        return _this;\n    }\n\n    return CompletedTodo;\n}(Todo);\n\nexports.CompletedTodo = CompletedTodo;\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      request.onupgradeneeded = function(event) {\n        if (upgradeCallback) {\n          upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n        }\n      };\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (true) {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// Unique ID creation requires a high quality random # generator.  We feature\n// detect to determine the best RNG source, normalizing to a function that\n// returns 128-bits of randomness, since that's what's usually required\nvar rng = __webpack_require__(8);\nvar bytesToUuid = __webpack_require__(7);\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\n// random #'s we need to init node and clockseq\nvar _seedBytes = rng();\n\n// Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\nvar _nodeId = [\n  _seedBytes[0] | 0x01,\n  _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n];\n\n// Per 4.2.2, randomize (14 bit) clockseq\nvar _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n// Previous uuid creation time\nvar _lastMSecs = 0, _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  var node = options.node || _nodeId;\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar rng = __webpack_require__(8);\nvar bytesToUuid = __webpack_require__(7);\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options == 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports) {\n\nvar g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.b80c165404aa08d62b55.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 28);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 026811f9dd3db6d56268","export function templateClone(id: string): DocumentFragment {\r\n    let selector = \"template#\" + id;\r\n    let template = document.querySelector(selector) as HTMLTemplateElement | null;\r\n    if (!template) {\r\n        throw new Error(`Document missing required '${selector}' element`);\r\n    }\r\n    let fragment = document.importNode(template.content, true);\r\n    return fragment;\r\n}\r\n\r\nexport function fillControllerElements(parentNode: NodeSelector, controllerName: string, newChild: DocumentFragment): void {\r\n    findControllerElements(parentNode, controllerName).forEach(elem => {\r\n        elem.innerHTML = \"\";\r\n        elem.appendChild(newChild)}\r\n    );\r\n}\r\n\r\nfunction findControllerElements(parentNode: NodeSelector, controllerName: string): NodeListOf<HTMLElement> {\r\n    let selector = `[data-estd-controller='${controllerName}']`;\r\n    return findAllElements(parentNode, selector) as NodeListOf<HTMLElement>;\r\n}\r\n\r\nexport function fillContentElements(parentNode: NodeSelector, propName: string, content: string): void {\r\n    findContentElements(parentNode, propName).forEach(elem => elem.textContent = content);\r\n}\r\n\r\nfunction findContentElements(parentNode: NodeSelector, propName: string): NodeListOf<Element> {\r\n    let selector = `[data-estd-content='${propName}']`;\r\n    return findAllElements(parentNode, selector);\r\n}\r\n\r\nexport function setAttrElements(parentNode: NodeSelector, attrName: string, value: string): void {\r\n    findAttrElements(parentNode, attrName).forEach(elem => elem.setAttribute(attrName, value));\r\n}\r\n\r\nfunction findAttrElements(parentNode: NodeSelector, attrName: string): NodeListOf<Element> {\r\n    let selector = `[data-estd-attr='${attrName}']`;\r\n    return findAllElements(parentNode, selector);\r\n}\r\n\r\nexport function findElement(parentNode: NodeSelector, selector: string): Element {\r\n    let element = parentNode.querySelector(selector);\r\n    if (!element) {\r\n        throw new Error(`'${parentNode}' missing required '${selector}' element`);\r\n    }\r\n    return element;\r\n}\r\n\r\nfunction findAllElements(parentNode: NodeSelector, selector: string): NodeListOf<Element> {\r\n    let elements = parentNode.querySelectorAll(selector);\r\n    if (!elements.length) {\r\n        throw new Error(`'${parentNode}' missing required '${selector}' element`);\r\n    }\r\n    return elements;\r\n}\r\n\r\nexport function getRequiredAttribute(element: Element, attributeName: string): string {\r\n    let value = element.getAttribute(attributeName);\r\n    if (!value) {\r\n        throw new Error(`'${element}' missing required '${attributeName}' attribute`);\r\n    }\r\n    return value;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./utils.ts","import { Dependencies } from \"./dependencies\";\r\nimport { AggregateIdType, domainEventsByAggregate } from \"./event-store\";\r\nimport { TodoList } from \"./domain/todo-list\";\r\nimport { fillControllerElements } from \"./utils\";\r\nimport { v4 as uuid } from \"uuid\";\r\n\r\nexport const todoIdDataAttrName = \"data-estd-todo-id\";\r\nexport const eventIdDataAttrName = \"data-estd-event-id\";\r\n\r\nexport function refreshLists(di: Dependencies, todoListId: AggregateIdType): Promise<void> {\r\n    return domainEventsByAggregate(todoListId)\r\n        .then(events => {\r\n            let todoList = new TodoList(events);\r\n            fillControllerElements(document, \"incompleteTodoListController\", di.incompleteTodoListController(di, todoList.todos));\r\n            fillControllerElements(document, \"completedTodoListController\", di.completedTodoListController(di, todoList.completedTodos));\r\n            fillControllerElements(document, \"eventListController\", di.eventListController(di, events));\r\n        });\r\n}\r\n\r\nexport function refreshBody(di: Dependencies, todoListId: AggregateIdType): Promise<void> {\r\n    return domainEventsByAggregate(todoListId)\r\n        .then(events => {\r\n            fillControllerElements(document, \"bodyController\", di.bodyController(di, events));\r\n        });\r\n}\r\n\r\nexport function invalidNameInputHandler(e: JQueryEventObject) {\r\n    let input = e.currentTarget as HTMLInputElement;\r\n    let $input = $(input);\r\n    let $form = $input.closest(\"form\");\r\n    let $button = $input.next().children(\"button\");\r\n    $form.addClass(\"has-error\");\r\n    $button.removeClass(\"btn-success\").addClass(\"btn-danger\");\r\n\r\n    let validationEventNamespace = \".nameTodoInputValidation:\" + uuid();\r\n    function clearValidation() {\r\n        $form.removeClass(\"has-error\");\r\n        $button.removeClass(\"btn-danger\").addClass(\"btn-success\");\r\n        $form.off(validationEventNamespace);\r\n        $input.off(validationEventNamespace);\r\n    }\r\n    $input.on(\"input\" + validationEventNamespace, function (e) {\r\n        if (input.validity.valid) {\r\n            clearValidation();\r\n        }\r\n    });\r\n    $form.on(\"focusout\" + validationEventNamespace, function (e) {\r\n        if (!e.currentTarget.contains(e.relatedTarget)) {\r\n            clearValidation();\r\n        }\r\n    });\r\n}\n\n\n// WEBPACK FOOTER //\n// ./app.common.ts","import idb, { DB } from \"idb\";\r\n\r\nexport enum DomainEventType {\r\n    TodoAdded,\r\n    TodoRemoved,\r\n    TodoCompleted,\r\n    TodoUncompleted,\r\n    TodoRenamed,\r\n    TodoPositionChanged\r\n}\r\nexport type AggregateIdType = string;\r\nexport interface UncommittedDomainEvent {\r\n    readonly aggregateId: AggregateIdType;\r\n    readonly type: DomainEventType;\r\n}\r\nexport interface DomainEvent extends UncommittedDomainEvent {\r\n    readonly id: number;\r\n}\r\nexport interface EventStore {\r\n    getAllDomainEvents(version?: number): Promise<DomainEvent[]>;\r\n    getDomainEventsByAggregate(aggregateId: AggregateIdType, version?: number): Promise<DomainEvent[]>;\r\n    postDomainEvents(events: UncommittedDomainEvent[]): Promise<void>;\r\n}\r\n\r\nconst dbName = \"estd-db\";\r\nconst domainEventStoreName = \"domain-event\";\r\nconst aggregateIdPropName = \"aggregateId\";\r\nconst eventIdPropName = \"id\";\r\n\r\nfunction open(): Promise<DB> {\r\n    return idb.open(dbName, 1, db => {\r\n        switch (db.oldVersion) {\r\n            case 0:\r\n                db.createObjectStore(domainEventStoreName, { autoIncrement: true, keyPath: eventIdPropName })\r\n                    .createIndex(aggregateIdPropName, aggregateIdPropName);\r\n        }\r\n    }).catch(reason => {\r\n        alert(\"Database error: \" + reason);\r\n    });\r\n}\r\nexport function allDomainEvents(version?: number): Promise<DomainEvent[]> {\r\n    return open().then(db => {\r\n        let store = db.transaction(domainEventStoreName).objectStore(domainEventStoreName);\r\n        return (version)\r\n            ? store.getAll(IDBKeyRange.upperBound(version))\r\n            : store.getAll();\r\n    }).catch(reason => {\r\n        alert(\"Database error: \" + reason);\r\n    });\r\n}\r\nexport function domainEventsByAggregate(aggregateId: AggregateIdType, version?: number): Promise<DomainEvent[]> {\r\n    return open().then(db => {\r\n        let index = db.transaction(domainEventStoreName).objectStore(domainEventStoreName).index(aggregateIdPropName);\r\n        let eventsPromise = index.getAll(aggregateId) as Promise<DomainEvent[]>;\r\n        return (version)\r\n            ? eventsPromise.then(events => events.filter(e => e.id <= version))\r\n            : eventsPromise;\r\n    }).catch(reason => {\r\n        alert(\"Database error: \" + reason);\r\n    });\r\n}\r\nexport function postDomainEvents(events: UncommittedDomainEvent[]): Promise<void> {\r\n    return open().then(db => {\r\n        let tx = db.transaction(domainEventStoreName, \"readwrite\");\r\n        let store = tx.objectStore(domainEventStoreName);\r\n        events.forEach(x => store.add(x));\r\n        return tx.complete;\r\n    }).catch(reason => {\r\n        alert(\"Database error: \" + reason);\r\n    });\r\n}\n\n\n// WEBPACK FOOTER //\n// ./event-store.ts","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/uuid/index.js\n// module id = 3\n// module chunks = 0","import { AggregateRoot } from \"./aggregate-root\";\r\nimport { Todo, CompletedTodo, TodoIdType } from \"./todo\";\r\nimport { TodoAdded, TodoRemoved, TodoCompleted, TodoUncompleted, TodoRenamed, TodoPositionChanged } from \"./events\";\r\nimport { v4 as uuid } from \"uuid\";\r\n\r\nexport class TodoList extends AggregateRoot {\r\n    protected _todos: (Todo | CompletedTodo)[];\r\n    get todos(): Todo[] {\r\n        return this._todos.filter(x => !x.isCompleted);\r\n    }\r\n    get completedTodos(): CompletedTodo[] {\r\n        return (this._todos.filter(x => x.isCompleted) as CompletedTodo[])\r\n            .sort((x, y) => {\r\n                return y.completionTimestamp - x.completionTimestamp\r\n            });\r\n    }\r\n    protected init(): void {\r\n        super.init();\r\n        this._todos = [];\r\n    }\r\n\r\n    // Domain Event Handlers\r\n    protected TodoAdded(e: TodoAdded): void {\r\n        if (!this.id) {\r\n            this._id = e.aggregateId;\r\n        }\r\n        this._todos.push(new Todo(e.todoId, e.todoName))\r\n    }\r\n    protected TodoRemoved(e: TodoRemoved): void {\r\n        let i = this._todos.findIndex(x => x.id === e.todoId);\r\n        if (i !== -1) {\r\n            this._todos.splice(i, 1)\r\n        }\r\n    }\r\n    protected TodoCompleted(e: TodoCompleted): void {\r\n        let i = this._todos.findIndex(x => x.id === e.todoId);\r\n        if (i !== -1) {\r\n            let oldTodo = this._todos[i];\r\n            let newTodo = new CompletedTodo(oldTodo.id, oldTodo.name, e.todoCompletionTimestamp);\r\n            this._todos[i] = newTodo;\r\n        }\r\n    }\r\n    protected TodoUncompleted(e: TodoUncompleted): void {\r\n        let i = this._todos.findIndex(x => x.id === e.todoId);\r\n        if (i !== -1) {\r\n            let oldTodo = this._todos[i];\r\n            let newTodo = new Todo(oldTodo.id, oldTodo.name);\r\n            this._todos[i] = newTodo;\r\n        }\r\n    }\r\n    protected TodoRenamed(e: TodoRenamed): void {\r\n        let todo = this._todos.find(x => x.id === e.todoId);\r\n        if (todo) {\r\n            todo.name = e.todoName;\r\n        }\r\n    }\r\n    protected TodoPositionChanged(e: TodoPositionChanged): void {\r\n        let incompleteTodoPositions: number[] = this._todos.reduce<number[]>((p, c, i) => {\r\n            if (!c.isCompleted) {\r\n                p.push(i);\r\n            }\r\n            return p;\r\n        }, new Array<number>());\r\n        let from = incompleteTodoPositions.findIndex(x => this._todos[x].id === e.todoId);\r\n        if (from === -1) {\r\n            return;\r\n        }\r\n        let to = from + e.todoOffset;\r\n        if (to < 0) {\r\n            to = 0;\r\n        } else if (to > incompleteTodoPositions.length - 1) {\r\n            to = incompleteTodoPositions.length - 1;\r\n        }\r\n        if (from === to) {\r\n            return;\r\n        }\r\n        if (to < from) {\r\n            for (let i = to; i < from; i++) {\r\n                arraySwap(this._todos, incompleteTodoPositions[from], incompleteTodoPositions[i]);\r\n            }\r\n        } else {\r\n            for (let i = to; i > from; i--) {\r\n                arraySwap(this._todos, incompleteTodoPositions[from], incompleteTodoPositions[i]);\r\n            }\r\n        }\r\n        function arraySwap(arr: Array<any>, x: number, y: number) {\r\n            let a = arr[x];\r\n            arr[x] = arr[y];\r\n            arr[y] = a;\r\n        }\r\n    }\r\n\r\n    add(id: TodoIdType, name: string) {\r\n        let agId = this.id || uuid();\r\n        this.applyAndStage(new TodoAdded(agId, id, name));\r\n    }\r\n    remove(id: TodoIdType) {\r\n        this.applyAndStage(new TodoRemoved(this.id, id));\r\n    }\r\n    complete(id: TodoIdType, completionTimestamp: number) {\r\n        this.applyAndStage(new TodoCompleted(this.id, id, completionTimestamp));\r\n    }\r\n    uncomplete(id: TodoIdType) {\r\n        this.applyAndStage(new TodoUncompleted(this.id, id));\r\n    }\r\n    rename(id: TodoIdType, name: string) {\r\n        this.applyAndStage(new TodoRenamed(this.id, id, name));\r\n    }\r\n    changePosition(id: TodoIdType, offset: number) {\r\n        this.applyAndStage(new TodoPositionChanged(this.id, id, offset));\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./domain/todo-list.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, fillControllerElements } from \"../utils\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function historyTodoController(di: Dependencies, todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = (todo.isCompleted)\r\n        ? templateClone(\"historyCompletedTodoTemplate\")\r\n        : templateClone(\"historyTodoTemplate\");\r\n    fillControllerElements(fragment, \"historyTodoTitlePanelController\", di.historyTodoTitlePanelController(di, todo));\r\n    return fragment;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/history-todo-controller.ts","import { AggregateIdType, DomainEvent, DomainEventType, allDomainEvents, domainEventsByAggregate } from \"./event-store\";\r\n\r\nexport function todoListEvents(): Promise<DomainEvent[]> {\r\n    // This app's domain and event-store are designed to accommodate multiple aggregates of different types.\r\n    // Currently, the app only has one aggregate type (TodoList) and only allows the user to have one instance of that aggregate.\r\n    // This todoLists() lookup occurs to get the aggreateId of the user's one TodoList.\r\n    return allDomainEvents()\r\n        .then(events => {\r\n            let lists = todoLists(events);\r\n            return (lists.length)\r\n                ? domainEventsByAggregate(lists[0])\r\n                : [];\r\n        })\r\n}\r\n\r\nfunction todoLists(events: DomainEvent[]): AggregateIdType[] {\r\n    return events.reduce<AggregateIdType[]>((p, c) => {\r\n        if (c.type === DomainEventType.TodoAdded && p.indexOf(c.aggregateId) === -1) {\r\n            p.push(c.aggregateId);\r\n        }\r\n        return p;\r\n    }, []);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./read.ts","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  return  bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\nmodule.exports = bytesToUuid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/uuid/lib/bytesToUuid.js\n// module id = 7\n// module chunks = 0","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\nvar rng;\n\nvar crypto = global.crypto || global.msCrypto; // for IE 11\nif (crypto && crypto.getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16);\n  rng = function whatwgRNG() {\n    crypto.getRandomValues(rnds8);\n    return rnds8;\n  };\n}\n\nif (!rng) {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var  rnds = new Array(16);\n  rng = function() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n\nmodule.exports = rng;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/uuid/lib/rng-browser.js\n// module id = 8\n// module chunks = 0","import { Dependencies } from \"../dependencies\";\r\nimport { templateClone, findElement } from \"../utils\";\r\nimport { invalidNameInputHandler } from \"../app.common\";\r\nimport { domainEventsByAggregate, postDomainEvents, AggregateIdType } from \"../event-store\";\r\nimport { todoListEvents } from \"../read\";\r\nimport { v4 as uuid } from \"uuid\";\r\nimport { TodoList } from \"../domain/todo-list\";\r\n\r\nexport function addTodoFormController(di: Dependencies, todoListId: AggregateIdType): DocumentFragment {\r\n    let fragment = templateClone(\"addTodoFormTemplate\");\r\n    let addTodoForm = findElement(fragment, \"#addTodoForm\") as HTMLFormElement;\r\n    let addTodoInput = findElement(addTodoForm, \"#addTodoInput\") as HTMLInputElement;\r\n    $(addTodoInput).on(\"invalid\", invalidNameInputHandler);\r\n    $(addTodoForm).submit(function (e) {\r\n        e.preventDefault();\r\n        // This is to deal with the possibility that the user opens the app for the first time in two tabs\r\n        // and adds a to-do to each new TodoList. TodoList ids are generated when the first Todo is\r\n        // added to them. So, on first load, there are no Todos and no TodoLists, and this handler\r\n        // can't know whether to create a new TodoList or load one that might have been made in another tab.\r\n        // So, if the current TodoList has no id -- i.e. no todos have been added -- we check if any other\r\n        // tab has added a new TodoList and use that id.\r\n        let eventsPromise = (todoListId)\r\n            ? domainEventsByAggregate(todoListId)\r\n            : todoListEvents();\r\n        eventsPromise.then((events) => {\r\n            let todoList = new TodoList(events);\r\n            todoList.add(uuid(), addTodoInput.value);\r\n            addTodoForm.reset();\r\n            // This assignment is only necessary when the first Todo is added to a new TodoList.\r\n            todoListId = todoList.id;\r\n            return postDomainEvents(todoList.uncommittedEvents);\r\n        }).then(() => di.refreshLists(di, todoListId));\r\n    });\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/add-todo-form-controller.ts","import { Dependencies } from \"../dependencies\";\r\nimport { DomainEvent } from \"../event-store\";\r\nimport { templateClone, fillControllerElements } from \"../utils\";\r\n\r\nexport function bodyController(di: Dependencies, events: DomainEvent[]): DocumentFragment {\r\n    let fragment = templateClone(\"bodyTemplate\");\r\n    fillControllerElements(fragment, \"todoListPanelController\", di.todoListPanelController(di, events));\r\n    fillControllerElements(fragment, \"eventListController\", di.eventListController(di, events));\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/body-controller.ts","import { CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, fillControllerElements } from \"../utils\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function completedTodoListController(di: Dependencies, todos: CompletedTodo[]): DocumentFragment {\r\n    if (!todos.length) {\r\n        return new DocumentFragment();\r\n    }\r\n    let fragment = templateClone(\"completedTodoListTemplate\");\r\n    fillControllerElements(fragment, \"todoListController\", di.todoListController(di, todos));\r\n    return fragment;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/completed-todo-list-controller.ts","import { templateClone, fillControllerElements, findElement, getRequiredAttribute } from \"../utils\";\r\nimport { DomainEvent } from \"../event-store\";\r\nimport { Dependencies } from \"../dependencies\";\r\nimport { eventIdDataAttrName } from \"../app.common\";\r\nimport { historyTodoController } from \"./history-todo-controller\";\r\nimport { v4 as uuid } from \"uuid\";\r\n\r\nexport function eventListController(di: Dependencies, events: DomainEvent[]): DocumentFragment {\r\n    if (!events.length) {\r\n        return templateClone(\"emptyEventListTemplate\");\r\n    }\r\n    let todoListId = events[0].aggregateId;\r\n    let fragment = templateClone(\"eventListTemplate\");\r\n    let historyDi = Object.assign({}, di);\r\n    historyDi.todoController = historyTodoController;\r\n    let eventListDelegatedEventTarget = findElement(fragment, \"#eventListDelegatedEventTarget\");\r\n    let $eventListDelegatedEventTarget = $(eventListDelegatedEventTarget);\r\n    $eventListDelegatedEventTarget.on(\"click\", \".event-list-item\", function (e) {\r\n        let refreshBodyEventNamespace = \".activeEventFocusOut:\" + uuid();\r\n        // This handler will reset the body to the interactive todolist when the user clicks\r\n        // anywhere in the document outside of the event list.\r\n        $(document).on(`click${refreshBodyEventNamespace} keypress${refreshBodyEventNamespace}`, function (e2) {\r\n            // Short-circuit when handler is triggered by event that created it\r\n            // or when isn't an 'enter' keypress\r\n            // or when the event-list-item contains the click target\r\n            if (e.originalEvent === e2.originalEvent\r\n                || (e2.type === \"keypress\" && e2.which !== 13)\r\n                || e.currentTarget.contains(e2.target)) {\r\n                return;\r\n            }\r\n            $(document).off(refreshBodyEventNamespace);\r\n            if (!eventListDelegatedEventTarget.contains(e2.target)) {\r\n                di.refreshBody(di, todoListId);\r\n            }\r\n        });\r\n        let eventId = getRequiredAttribute(e.currentTarget, eventIdDataAttrName);\r\n        let historyEvents = events.slice(0, parseInt(eventId));\r\n        fillControllerElements(document, \"todoListPanelController\", historyDi.historyTodoListPanelController(historyDi, historyEvents));\r\n    });\r\n    fillControllerElements(fragment, \"eventListGroupController\", di.eventListGroupController(di, events));\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/event-list-controller.ts","import { DomainEvent } from \"../event-store\";\r\nimport { templateClone, fillControllerElements, setAttrElements } from \"../utils\";\r\nimport { Dependencies } from \"../dependencies\";\r\nimport { eventIdDataAttrName } from \"../app.common\";\r\n\r\nexport function eventListGroupController(di: Dependencies, events: DomainEvent[]): DocumentFragment {\r\n    if (events.length) {\r\n        let fragment = new DocumentFragment();\r\n        events.forEach(e => {\r\n            let listItemFragment = templateClone(\"eventListItemTemplate\");\r\n            setAttrElements(listItemFragment, eventIdDataAttrName, e.id.toString());\r\n            fillControllerElements(listItemFragment, \"eventTextController\", di.eventTextController(di, e));\r\n            fragment.appendChild(listItemFragment);\r\n        });\r\n        return fragment;\r\n    } else {\r\n        let fragment = templateClone(\"emptyEventListTemplate\");\r\n        return fragment;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/event-list-group-controller.ts","import { DomainEvent, DomainEventType } from \"../event-store\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function eventTextController(di: Dependencies, event: DomainEvent): DocumentFragment {\r\n    let fragment = new DocumentFragment();\r\n    fragment.textContent = `${event.id} : ${DomainEventType[event.type]}`;\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/event-text-controller.ts","import { Dependencies } from \"../dependencies\";\r\nimport { DomainEvent } from \"../event-store\";\r\nimport { templateClone, fillControllerElements } from \"../utils\";\r\nimport { TodoList } from \"../domain/todo-list\";\r\n\r\nexport function historyTodoListPanelController(di: Dependencies, events: DomainEvent[]): DocumentFragment {\r\n    let fragment = templateClone(\"historyTodoListPanelTemplate\");\r\n    let todoList = new TodoList(events);\r\n    fillControllerElements(fragment, \"incompleteTodoListController\", di.incompleteTodoListController(di, todoList.todos));\r\n    fillControllerElements(fragment, \"completedTodoListController\", di.completedTodoListController(di, todoList.completedTodos));\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/history-todo-list-panel-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, fillControllerElements } from \"../utils\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function historyTodoTitlePanelController(di: Dependencies, todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = templateClone(\"historyTodoTitlePanelTemplate\");\r\n    fillControllerElements(fragment, \"todoTitleController\", di.todoTitleController(di, todo));\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/history-todo-title-panel-controller.ts","import { Todo } from \"../domain/todo\";\r\nimport { templateClone, fillControllerElements } from \"../utils\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function incompleteTodoListController(di: Dependencies, todos: Todo[]): DocumentFragment {\r\n    if (!todos.length) {\r\n        return new DocumentFragment();\r\n    }\r\n    let fragment = templateClone(\"incompleteTodoListTemplate\");\r\n    fillControllerElements(fragment, \"todoListController\", di.todoListController(di, todos)); \r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/incomplete-todo-list-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, setAttrElements } from \"../utils\";\r\nimport { todoIdDataAttrName } from \"../app.common\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function todoActionsPanelButtonsController(di: Dependencies, todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = templateClone(\"todoDeleteBtnTemplate\");\r\n    if (!todo.isCompleted) {\r\n        fragment.appendChild(templateClone(\"todoMoveUpBtnTemplate\"));\r\n        fragment.appendChild(templateClone(\"todoMoveDownBtnTemplate\"));\r\n    }\r\n    fragment.appendChild(templateClone(\"todoRenameBtnTemplate\"));\r\n    setAttrElements(fragment, todoIdDataAttrName, todo.id);\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-actions-panel-buttons-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, fillControllerElements } from \"../utils\";\r\nimport { todoTitleController } from \"./todo-title-controller\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function todoActionsPanelController(di: Dependencies, todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = templateClone(\"todoActionsPanelTemplate\");\r\n    fillControllerElements(fragment, \"todoTitleController\", di.todoTitleController(di, todo));\r\n    fillControllerElements(fragment, \"todoActionsPanelButtonsController\", di.todoActionsPanelButtonsController(di, todo));\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-actions-panel-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, fillControllerElements, setAttrElements } from \"../utils\";\r\nimport { todoIdDataAttrName } from \"../app.common\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function todoController(di: Dependencies, todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = (todo.isCompleted)\r\n        ? templateClone(\"completedTodoTemplate\")\r\n        : templateClone(\"todoTemplate\");\r\n    setAttrElements(fragment, todoIdDataAttrName, todo.id);\r\n    fillControllerElements(fragment, \"todoTitlePanelController\", di.todoTitlePanelController(di, todo));\r\n    fillControllerElements(fragment, \"todoActionsPanelController\", di.todoActionsPanelController(di, todo));\r\n    fillControllerElements(fragment, \"todoRenamePanelController\", di.todoRenamePanelController(di, todo));\r\n    return fragment;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, fillControllerElements } from \"../utils\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function todoListController(di: Dependencies, todos: (Todo | CompletedTodo)[]): DocumentFragment {\r\n    let fragment = templateClone(\"todoListTemplate\");\r\n    fillControllerElements(fragment, \"todoListGroupController\", di.todoListGroupController(di, todos));\r\n    return fragment;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-list-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function todoListGroupController(di: Dependencies, todos: (Todo | CompletedTodo)[]): DocumentFragment {\r\n    let fragment = new DocumentFragment();\r\n    for (const todo of todos) {\r\n        fragment.appendChild(di.todoController(di, todo))\r\n    }\r\n    return fragment;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-list-group-controller.ts","import { Dependencies } from \"../dependencies\";\r\nimport { DomainEvent, domainEventsByAggregate, postDomainEvents, AggregateIdType } from \"../event-store\";\r\nimport { templateClone, findElement, getRequiredAttribute, fillControllerElements } from \"../utils\";\r\nimport { TodoList } from \"../domain/todo-list\";\r\nimport { todoIdDataAttrName } from \"../app.common\";\r\nimport { v4 as uuid } from \"uuid\";\r\n\r\nexport function todoListPanelController(di: Dependencies, events: DomainEvent[]): DocumentFragment {\r\n    let fragment = templateClone(\"todoListPanelTemplate\");\r\n    let todoList = new TodoList(events);\r\n    let todoListId = todoList.id;\r\n    let $todoListDelegatedEventTarget = $(findElement(fragment, \"#todolistDelegatedEventTarget\"));\r\n    $todoListDelegatedEventTarget.on(\"submit\", \".renameTodoForm\", function (e) {\r\n        e.preventDefault();\r\n        domainEventsByAggregate(todoListId)\r\n            .then(events => {\r\n                let todoList = new TodoList(events);\r\n                let todoName = $(e.currentTarget).find(\"input[name='name']\").val();\r\n                let todoId = getRequiredAttribute(e.currentTarget, todoIdDataAttrName);\r\n                todoList.rename(todoId, todoName);\r\n                return postDomainEvents(todoList.uncommittedEvents);\r\n            }).then(() => di.refreshLists(di, todoListId));\r\n    });\r\n    // Need to handle keypress here because the completeTodoBtn is an <a> without an href,\r\n    // so tabbing to it and pressing enter doesn't trigger a click event like it would with a <button>.\r\n    // I want completeTodoBtn to act like a <button>, but it has another <button> inside of it (todoActionsBtn),\r\n    // so browsers and Bootstrap styling wouldn't work if it was a <button> (HTML spec says no interactive content\r\n    // inside interactive content). By using an <a> with no href I get the a.list-group-item Bootstrap styling.\r\n    $todoListDelegatedEventTarget.on(\"click keypress\", \".completeTodoBtn\", function (e) {\r\n        completeTodoBtnHandler(e, true);\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"click keypress\", \".uncompleteTodoBtn\", function (e) {\r\n        completeTodoBtnHandler(e, false);\r\n    });\r\n    function completeTodoBtnHandler(e: JQueryEventObject, isComplete: boolean): void {\r\n        // only handle \"enter\" keypresses\r\n        if (e.type === \"keypress\" && e.which !== 13) {\r\n            return;\r\n        }\r\n        // short-circuit if this event has bubbled up from the todoActionsBtn (which is inside (un)complete todo buttons)\r\n        var todoActionsBtn = $(e.currentTarget).find(\".todoActionsBtn\")[0];\r\n        if (todoActionsBtn === e.target || $.contains(todoActionsBtn, e.target)) {\r\n            return;\r\n        }\r\n        domainEventsByAggregate(todoListId)\r\n            .then(events => {\r\n                let todoList = new TodoList(events);\r\n                let todoId = getRequiredAttribute(e.currentTarget, todoIdDataAttrName);\r\n                if (isComplete) {\r\n                    todoList.complete(todoId, Date.now());\r\n                } else {\r\n                    todoList.uncomplete(todoId);\r\n                }\r\n                return postDomainEvents(todoList.uncommittedEvents);\r\n            }).then(() => di.refreshLists(di, todoListId));\r\n    }\r\n    $todoListDelegatedEventTarget.on(\"click\", \".moveTodoUpBtn\", function (e) {\r\n        domainEventsByAggregate(todoListId)\r\n            .then(events => {\r\n                let todoList = new TodoList(events);\r\n                let todoId = getRequiredAttribute(e.currentTarget, todoIdDataAttrName);\r\n                todoList.changePosition(todoId, -1);\r\n                return postDomainEvents(todoList.uncommittedEvents);\r\n            }).then(() => di.refreshLists(di, todoListId));\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"click\", \".moveTodoDownBtn\", function (e) {\r\n        domainEventsByAggregate(todoListId)\r\n            .then(events => {\r\n                let todoList = new TodoList(events);\r\n                let todoId = getRequiredAttribute(e.currentTarget, todoIdDataAttrName);\r\n                todoList.changePosition(todoId, 1);\r\n                return postDomainEvents(todoList.uncommittedEvents);\r\n            }).then(() => di.refreshLists(di, todoListId));\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"click\", \".deleteTodoBtn\", function (e) {\r\n        domainEventsByAggregate(todoListId)\r\n            .then(events => {\r\n                let todoList = new TodoList(events);\r\n                let todoId = getRequiredAttribute(e.currentTarget, todoIdDataAttrName);\r\n                todoList.remove(todoId);\r\n                return postDomainEvents(todoList.uncommittedEvents);\r\n            }).then(() => di.refreshLists(di, todoListId));\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"click\", \".todoActionsBtn\", function (e) {\r\n        var $defaultPanel = $(e.currentTarget).closest(\".todoPanelDefault\"),\r\n            $actionsPanel = $defaultPanel.next(),\r\n            $bothPanels = $defaultPanel.add($actionsPanel),\r\n            actionsBtnGroup = $actionsPanel.find(\".todoActionsPanelBtnGroup\")[0],\r\n            eventNamespace = \"click.todoActionsPanelClose:\" + uuid();\r\n        $bothPanels.toggle();\r\n\r\n        // This handler will close (i.e. toggle) the ActionsPanel when the user clicks anywhere in the document outside of the actionsBtnGroup.\r\n        // eventNamespace is unique (probably) so each instance of this handler can only detach itself.\r\n        $(document).on(eventNamespace, function (closeEvent) {\r\n            // Short-circuit when handler is triggered by event that created it.\r\n            // This happens because this handler is created in the todolistDelegatedEventTarget handler but attached to the document.\r\n            // So, when the todolistDelegatedEventTarget handler returns, the click event that triggered it will still bubble to the document.\r\n            if (e.originalEvent === closeEvent.originalEvent) {\r\n                return;\r\n            }\r\n            if (!$.contains(actionsBtnGroup, closeEvent.target)) {\r\n                $bothPanels.toggle();\r\n            }\r\n            $(document).off(eventNamespace);\r\n        });\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"click\", \".renameTodoBtn\", function (e) {\r\n        var $actionsPanel = $(e.currentTarget).closest(\".todoActionsPanel\");\r\n        var $renamePanel = $actionsPanel.next();\r\n        $actionsPanel.add($renamePanel).toggle();\r\n        $renamePanel.find(\".renameTodoBtnClickFocusTarget\").first().focus();\r\n    });\r\n    $todoListDelegatedEventTarget.on(\"blur\", \".renameTodoForm\", function (e) {\r\n        if (!(e.relatedTarget && $.contains(e.currentTarget, e.relatedTarget))) {\r\n            var $renamePanel = $(e.currentTarget).closest(\".todoRenamePanel\");\r\n            $renamePanel.prev().prev().add($renamePanel).toggle();\r\n        }\r\n    });\r\n\r\n    fillControllerElements(fragment, \"addTodoFormController\", di.addTodoFormController(di, todoListId));\r\n    fillControllerElements(fragment, \"incompleteTodoListController\", di.incompleteTodoListController(di, todoList.todos));\r\n    fillControllerElements(fragment, \"completedTodoListController\", di.completedTodoListController(di, todoList.completedTodos));\r\n    return fragment;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-list-panel-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, findElement, setAttrElements } from \"../utils\";\r\nimport { invalidNameInputHandler, todoIdDataAttrName } from \"../app.common\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function todoRenamePanelController(di: Dependencies, todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = templateClone(\"todoRenamePanelTemplate\");\r\n    let input = findElement(fragment, \"input[name='name']\");\r\n    let inputId = input.getAttribute(\"id\");\r\n    let newInputId = `${inputId}-${todo.id}`;\r\n    let label = findElement(fragment, `label[for='${inputId}']`);\r\n    input.setAttribute(\"id\", newInputId);\r\n    input.setAttribute(\"value\", todo.name);\r\n    label.setAttribute(\"for\", newInputId);\r\n    setAttrElements(fragment, todoIdDataAttrName, todo.id);\r\n    $(input).on(\"invalid\", invalidNameInputHandler);\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-rename-panel-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, fillContentElements } from \"../utils\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function todoTitleController(di: Dependencies, todo: Todo | CompletedTodo): DocumentFragment {\r\n    let titleFragment = new DocumentFragment();\r\n    titleFragment.textContent = todo.name;\r\n    if (todo.isCompleted) {\r\n        let completionDateFragment = templateClone(\"todoCompletionDateTemplate\");\r\n        let date = new Date((todo as CompletedTodo).completionTimestamp);\r\n        fillContentElements(completionDateFragment, \"completionDate\", date.toLocaleDateString());\r\n        titleFragment.appendChild(completionDateFragment);\r\n    }\r\n    return titleFragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-title-controller.ts","import { Todo, CompletedTodo } from \"../domain/todo\";\r\nimport { templateClone, fillControllerElements } from \"../utils\";\r\nimport { Dependencies } from \"../dependencies\";\r\n\r\nexport function todoTitlePanelController(di: Dependencies, todo: Todo | CompletedTodo): DocumentFragment {\r\n    let fragment = templateClone(\"todoTitlePanelTemplate\");\r\n    fillControllerElements(fragment, \"todoTitleController\", di.todoTitleController(di, todo));\r\n    return fragment;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/todo-title-panel-controller.ts","import \"./site.css\";\r\nimport { fillControllerElements } from \"./utils\";\r\nimport { todoListEvents } from \"./read\";\r\nimport { Dependencies } from \"./dependencies\";\r\nimport { bodyController } from \"./controllers/body-controller\";\r\nimport { incompleteTodoListController } from \"./controllers/incomplete-todo-list-controller\";\r\nimport { completedTodoListController } from \"./controllers/completed-todo-list-controller\";\r\nimport { todoListController } from \"./controllers/todo-list-controller\";\r\nimport { todoListGroupController } from \"./controllers/todo-list-group-controller\";\r\nimport { todoController } from \"./controllers/todo-controller\";\r\nimport { todoTitlePanelController } from \"./controllers/todo-title-panel-controller\";\r\nimport { todoTitleController } from \"./controllers/todo-title-controller\";\r\nimport { todoActionsPanelController } from \"./controllers/todo-actions-panel-controller\";\r\nimport { todoActionsPanelButtonsController } from \"./controllers/todo-actions-panel-buttons-controller\";\r\nimport { todoRenamePanelController } from \"./controllers/todo-rename-panel-controller\";\r\nimport { eventListController } from \"./controllers/event-list-controller\";\r\nimport { eventListGroupController } from \"./controllers/event-list-group-controller\";\r\nimport { eventTextController } from \"./controllers/event-text-controller\";\r\nimport { addTodoFormController } from \"./controllers/add-todo-form-controller\";\r\nimport { todoListPanelController } from \"./controllers/todo-list-panel-controller\";\r\nimport { historyTodoListPanelController } from \"./controllers/history-todo-list-panel-controller\";\r\nimport { historyTodoController } from \"./controllers/history-todo-controller\";\r\nimport { historyTodoTitlePanelController } from \"./controllers/history-todo-title-panel-controller\";\r\nimport { refreshLists, refreshBody } from \"./app.common\";\r\n\r\nif (!window.indexedDB) {\r\n    window.alert(\"Your browser doesn't support IndexedDB (the browser feature this app uses to store your To-dos). Update your browser to its latest version.\");\r\n}\r\n\r\nconst di: Dependencies = {\r\n    bodyController: bodyController,\r\n    todoListPanelController: todoListPanelController,\r\n    addTodoFormController: addTodoFormController,\r\n    incompleteTodoListController: incompleteTodoListController,\r\n    completedTodoListController: completedTodoListController,\r\n    todoListController: todoListController,\r\n    todoListGroupController: todoListGroupController,\r\n    todoController: todoController,\r\n    todoTitlePanelController: todoTitlePanelController,\r\n    todoTitleController: todoTitleController,\r\n    todoActionsPanelController: todoActionsPanelController,\r\n    todoActionsPanelButtonsController: todoActionsPanelButtonsController,\r\n    todoRenamePanelController: todoRenamePanelController,\r\n    eventListController: eventListController,\r\n    eventListGroupController: eventListGroupController,\r\n    eventTextController: eventTextController,\r\n    refreshLists: refreshLists,\r\n    refreshBody: refreshBody,\r\n    historyTodoListPanelController: historyTodoListPanelController,\r\n    historyTodoController: historyTodoController,\r\n    historyTodoTitlePanelController: historyTodoTitlePanelController\r\n}\r\n\r\ntodoListEvents()\r\n    .then(events => {\r\n        fillControllerElements(document, \"bodyController\", di.bodyController(di, events));\r\n    });\n\n\n// WEBPACK FOOTER //\n// ./app.ts","import { DomainEvent, UncommittedDomainEvent, AggregateIdType, DomainEventType } from \"../event-store\";\r\n\r\nexport type DomainEventHandler = (e: UncommittedDomainEvent) => void\r\n\r\nexport abstract class AggregateRoot {\r\n    private _uncommittedEvents: UncommittedDomainEvent[];\r\n    get uncommittedEvents(): UncommittedDomainEvent[] {\r\n        return this._uncommittedEvents;\r\n    }\r\n    protected _id: AggregateIdType\r\n    get id(): AggregateIdType {\r\n        return this._id;\r\n    }\r\n    protected init(): void {\r\n        this._uncommittedEvents = new Array<UncommittedDomainEvent>();\r\n    };\r\n    constructor(events: DomainEvent[]) {\r\n        this.init();\r\n        events.forEach(e => {\r\n            ((this as any)[DomainEventType[e.type]] as DomainEventHandler)(e);\r\n        });\r\n    }\r\n    protected applyAndStage(e: UncommittedDomainEvent) {\r\n        ((this as any)[DomainEventType[e.type]] as DomainEventHandler)(e);\r\n        this._uncommittedEvents.push(e);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./domain/aggregate-root.ts","import { TodoIdType } from \"./todo\";\r\nimport { UncommittedDomainEvent, AggregateIdType, DomainEventType } from \"../event-store\";\r\n\r\nexport class TodoAdded implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoAdded;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType,\r\n        readonly todoName: string\r\n    ) { }\r\n}\r\n\r\nexport class TodoRemoved implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoRemoved;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType\r\n    ) { }\r\n}\r\n\r\nexport class TodoCompleted implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoCompleted;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType,\r\n        readonly todoCompletionTimestamp: number\r\n    ) { }\r\n}\r\n\r\nexport class TodoUncompleted implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoUncompleted;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType\r\n    ) { }\r\n}\r\n\r\nexport class TodoRenamed implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoRenamed;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType,\r\n        readonly todoName: string\r\n    ) { }\r\n}\r\n\r\nexport class TodoPositionChanged implements UncommittedDomainEvent {\r\n    readonly type = DomainEventType.TodoPositionChanged;\r\n    constructor(\r\n        readonly aggregateId: AggregateIdType,\r\n        readonly todoId: TodoIdType,\r\n        readonly todoOffset: number\r\n    ) { }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./domain/events.ts","export type TodoIdType = string;\r\n\r\nexport class Todo {\r\n    readonly isCompleted: boolean = false;\r\n    constructor(\r\n        readonly id: TodoIdType,\r\n        public name: string\r\n    ) { }\r\n}\r\n\r\nexport class CompletedTodo extends Todo {\r\n    readonly isCompleted: boolean = true;\r\n    constructor(\r\n        id: TodoIdType,\r\n        name: string,\r\n        readonly completionTimestamp: number\r\n    ) {\r\n        super(id, name);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./domain/todo.ts","'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      request.onupgradeneeded = function(event) {\n        if (upgradeCallback) {\n          upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n        }\n      };\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/idb/lib/idb.js\n// module id = 32\n// module chunks = 0","// Unique ID creation requires a high quality random # generator.  We feature\n// detect to determine the best RNG source, normalizing to a function that\n// returns 128-bits of randomness, since that's what's usually required\nvar rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\n// random #'s we need to init node and clockseq\nvar _seedBytes = rng();\n\n// Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\nvar _nodeId = [\n  _seedBytes[0] | 0x01,\n  _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n];\n\n// Per 4.2.2, randomize (14 bit) clockseq\nvar _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n// Previous uuid creation time\nvar _lastMSecs = 0, _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  var node = options.node || _nodeId;\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/uuid/v1.js\n// module id = 33\n// module chunks = 0","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options == 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/uuid/v4.js\n// module id = 34\n// module chunks = 0","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 35\n// module chunks = 0"],"sourceRoot":""}